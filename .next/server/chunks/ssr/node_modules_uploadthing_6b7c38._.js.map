{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/yurtur/projects/candle-constructor/node_modules/uploadthing/internal/types.js"],"sourcesContent":["/**\n * Marker used to append a `customId` to the incoming file data in `.middleware()`\n * @example\n * ```ts\n * .middleware((opts) => {\n *   return {\n *     [UTFiles]: opts.files.map((file) => ({\n *       ...file,\n *       customId: generateId(),\n *     }))\n *   };\n * })\n * ```\n */ const UTFiles = Symbol(\"uploadthing-custom-id-symbol\");\n\nexport { UTFiles };\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;CAaC;;;AAAG,MAAM,UAAU,OAAO","ignoreList":[0]}},
    {"offset": {"line": 25, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["file:///home/yurtur/projects/candle-constructor/node_modules/uploadthing/next/index.js"],"sourcesContent":["import * as Effect from 'effect/Effect';\nimport { FetchHttpClient, Headers, HttpApp, HttpServerResponse, HttpServerRequest, HttpRouter, HttpClient, HttpClientRequest, HttpClientResponse, HttpBody } from '@effect/platform';\nimport * as Config from 'effect/Config';\nimport * as Context from 'effect/Context';\nimport * as Match from 'effect/Match';\nimport * as Redacted from 'effect/Redacted';\nimport * as S from 'effect/Schema';\nimport { ValidContentDispositions, ValidACLs, filterDefinedObjectValues, UploadThingError, matchFileType, objectKeys, InvalidRouteConfigError, fileSizeToBytes, fillInputRouteConfig, bytesToFileSize, getStatusCodeFromError, verifySignature, generateKey, generateSignedURL } from '@uploadthing/shared';\nimport * as ConfigProvider from 'effect/ConfigProvider';\nimport * as Stream from 'effect/Stream';\nimport * as Layer from 'effect/Layer';\nimport * as Logger from 'effect/Logger';\nimport * as LogLevel from 'effect/LogLevel';\nimport * as Cause from 'effect/Cause';\nimport * as Data from 'effect/Data';\nimport * as Runtime from 'effect/Runtime';\nimport * as FiberRef from 'effect/FiberRef';\nimport * as ManagedRuntime from 'effect/ManagedRuntime';\nimport { UTFiles } from '../internal/types.js';\nexport { UTFiles } from '../internal/types.js';\n\nvar version = \"7.4.1\";\n\nS.Literal(...ValidContentDispositions);\nS.Literal(...ValidACLs);\n/**\n * Valid options for the `?actionType` query param\n */ const ActionType = S.Literal(\"upload\");\n/**\n * Valid options for the `uploadthing-hook` header\n * for requests coming from UT server\n */ const UploadThingHook = S.Literal(\"callback\", \"error\");\n/**\n * =============================================================================\n * =========================== Configuration ===================================\n * =============================================================================\n */ const DecodeString = S.transform(S.Uint8ArrayFromSelf, S.String, {\n    decode: (data)=>new TextDecoder().decode(data),\n    encode: (data)=>new TextEncoder().encode(data)\n});\nconst ParsedToken = S.Struct({\n    apiKey: S.Redacted(S.String.pipe(S.startsWith(\"sk_\"))),\n    appId: S.String,\n    regions: S.NonEmptyArray(S.String),\n    ingestHost: S.String.pipe(S.optionalWith({\n        default: ()=>\"ingest.uploadthing.com\"\n    }))\n});\nconst UploadThingToken = S.Uint8ArrayFromBase64.pipe(S.compose(DecodeString), S.compose(S.parseJson(ParsedToken)));\n/**\n * =============================================================================\n * ======================== File Type Hierarchy ===============================\n * =============================================================================\n */ /**\n * Properties from the web File object, this is what the client sends when initiating an upload\n */ class FileUploadData extends S.Class(\"FileUploadData\")({\n    name: S.String,\n    size: S.Number,\n    type: S.String,\n    lastModified: S.Number.pipe(S.optional)\n}) {\n}\n/**\n * `.middleware()` can add a customId to the incoming file data\n */ class FileUploadDataWithCustomId extends FileUploadData.extend(\"FileUploadDataWithCustomId\")({\n    customId: S.NullOr(S.String)\n}) {\n}\n/**\n * When files are uploaded, we get back\n * - a key\n * - a direct URL for the file\n * - an app-specific URL for the file (useful for scoping eg. for optimization allowed origins)\n * - the hash (md5-hex) of the uploaded file's contents\n */ class UploadedFileData extends FileUploadDataWithCustomId.extend(\"UploadedFileData\")({\n    key: S.String,\n    url: S.String,\n    appUrl: S.String,\n    fileHash: S.String\n}) {\n}\n/**\n * =============================================================================\n * ======================== Server Response Schemas ============================\n * =============================================================================\n */ class NewPresignedUrl extends S.Class(\"NewPresignedUrl\")({\n    url: S.String,\n    key: S.String,\n    customId: S.NullOr(S.String),\n    name: S.String\n}) {\n}\nclass MetadataFetchStreamPart extends S.Class(\"MetadataFetchStreamPart\")({\n    payload: S.String,\n    signature: S.String,\n    hook: UploadThingHook\n}) {\n}\nclass MetadataFetchResponse extends S.Class(\"MetadataFetchResponse\")({\n    ok: S.Boolean\n}) {\n}\nclass CallbackResultResponse extends S.Class(\"CallbackResultResponse\")({\n    ok: S.Boolean\n}) {\n}\n/**\n * =============================================================================\n * ======================== Client Action Payloads ============================\n * =============================================================================\n */ class UploadActionPayload extends S.Class(\"UploadActionPayload\")({\n    files: S.Array(FileUploadData),\n    input: S.Unknown\n}) {\n}\n\n/**\n * Merge in `import.meta.env` to the built-in `process.env` provider\n * Prefix keys with `UPLOADTHING_` so we can reference just the name.\n * @example\n * process.env.UPLOADTHING_TOKEN = \"foo\"\n * Config.string(\"token\"); // Config<\"foo\">\n */ const envProvider = ConfigProvider.fromEnv().pipe(ConfigProvider.orElse(()=>ConfigProvider.fromMap(new Map(Object.entries(filterDefinedObjectValues(// fuck this I give up. import.meta is a mistake, someone else can fix it\n    import.meta?.env ?? {}))), {\n        pathDelim: \"_\"\n    })), ConfigProvider.nested(\"uploadthing\"), ConfigProvider.constantCase);\n/**\n * Config provider that merges the options from the object\n * and environment variables prefixed with `UPLOADTHING_`.\n * @remarks Options take precedence over environment variables.\n */ const configProvider = (options)=>ConfigProvider.fromJson(options ?? {}).pipe(ConfigProvider.orElse(()=>envProvider));\nconst IsDevelopment = Config.boolean(\"isDev\").pipe(Config.orElse(()=>Config.succeed(typeof process !== \"undefined\" ? \"production\" : undefined).pipe(Config.map((_)=>_ === \"development\"))), Config.withDefault(false));\nconst UTToken = S.Config(\"token\", UploadThingToken).pipe(Effect.catchTags({\n    ConfigError: (e)=>new UploadThingError({\n            code: e._op === \"InvalidData\" ? \"INVALID_SERVER_CONFIG\" : \"MISSING_ENV\",\n            message: e._op === \"InvalidData\" ? \"Invalid token. A token is a base64 encoded JSON object matching { apiKey: string, appId: string, regions: string[] }.\" : \"Missing token. Please set the `UPLOADTHING_TOKEN` environment variable or provide a token manually through config.\",\n            cause: e\n        })\n}));\nConfig.string(\"apiUrl\").pipe(Config.withDefault(\"https://api.uploadthing.com\"), Config.mapAttempt((_)=>new URL(_)), Config.map((url)=>url.href.replace(/\\/$/, \"\")));\nconst IngestUrl = Effect.gen(function*() {\n    const { regions, ingestHost } = yield* UTToken;\n    const region = regions[0]; // Currently only support 1 region per app\n    return yield* Config.string(\"ingestUrl\").pipe(Config.withDefault(`https://${region}.${ingestHost}`), Config.mapAttempt((_)=>new URL(_)), Config.map((url)=>url.href.replace(/\\/$/, \"\")));\n});\n\nfunction defaultErrorFormatter(error) {\n    return {\n        message: error.message\n    };\n}\nfunction formatError(error, router) {\n    const errorFormatter = router[Object.keys(router)[0]]?.errorFormatter ?? defaultErrorFormatter;\n    return errorFormatter(error);\n}\n\nconst handleJsonLineStream = (schema, onChunk)=>(stream)=>{\n        let buf = \"\";\n        return stream.pipe(Stream.decodeText(), Stream.mapEffect((chunk)=>Effect.gen(function*() {\n                buf += chunk;\n                // Scan buffer for newlines\n                const parts = buf.split(\"\\n\");\n                const validChunks = [];\n                for (const part of parts){\n                    try {\n                        // Attempt to parse chunk as JSON\n                        validChunks.push(JSON.parse(part));\n                        // Advance buffer if parsing succeeded\n                        buf = buf.slice(part.length + 1);\n                    } catch  {\n                    //\n                    }\n                }\n                yield* Effect.logDebug(\"Received chunks\").pipe(Effect.annotateLogs(\"chunk\", chunk), Effect.annotateLogs(\"parsedChunks\", validChunks), Effect.annotateLogs(\"buf\", buf));\n                return validChunks;\n            })), Stream.mapEffect(S.decodeUnknown(S.Array(schema))), Stream.mapEffect(Effect.forEach((part)=>onChunk(part))), Stream.runDrain, Effect.withLogSpan(\"handleJsonLineStream\"));\n    };\n\nconst withMinimalLogLevel = Config.logLevel(\"logLevel\").pipe(Config.withDefault(LogLevel.Info), Effect.andThen((level)=>Logger.minimumLogLevel(level)), Effect.tapError((e)=>Effect.logError(\"Invalid log level\").pipe(Effect.annotateLogs(\"error\", e))), Effect.catchTag(\"ConfigError\", (e)=>new UploadThingError({\n        code: \"INVALID_SERVER_CONFIG\",\n        message: \"Invalid server configuration\",\n        cause: e\n    })), Layer.unwrapEffect);\nconst LogFormat = Config.literal(\"json\", \"logFmt\", \"structured\", \"pretty\")(\"logFormat\");\nconst withLogFormat = Effect.gen(function*() {\n    const isDev = yield* IsDevelopment;\n    const logFormat = yield* LogFormat.pipe(Config.withDefault(isDev ? \"pretty\" : \"json\"));\n    return Logger[logFormat];\n}).pipe(Effect.catchTag(\"ConfigError\", (e)=>new UploadThingError({\n        code: \"INVALID_SERVER_CONFIG\",\n        message: \"Invalid server configuration\",\n        cause: e\n    })), Layer.unwrapEffect);\nconst logHttpClientResponse = (message, opts)=>{\n    const mixin = opts?.mixin ?? \"json\";\n    const level = LogLevel.fromLiteral(opts?.level ?? \"Debug\");\n    return (response)=>Effect.flatMap(mixin !== \"None\" ? response[mixin] : Effect.void, ()=>Effect.logWithLevel(level, `${message} (${response.status})`).pipe(Effect.annotateLogs(\"response\", response)));\n};\nconst logHttpClientError = (message)=>(err)=>err._tag === \"ResponseError\" ? logHttpClientResponse(message, {\n            level: \"Error\"\n        })(err.response) : Effect.logError(message).pipe(Effect.annotateLogs(\"error\", err));\n\nclass ParserError extends Data.TaggedError(\"ParserError\") {\n    constructor(...args){\n        super(...args), this.message = \"Input validation failed. The original error with it's validation issues is in the error cause.\";\n    }\n}\nfunction getParseFn(parser) {\n    if (\"~standard\" in parser) {\n        /**\n     * Standard Schema\n     */ return async (value)=>{\n            const result = await parser[\"~standard\"].validate(value);\n            if (result.issues) {\n                throw new ParserError({\n                    cause: result.issues\n                });\n            }\n            return result.value;\n        };\n    }\n    if (\"parseAsync\" in parser && typeof parser.parseAsync === \"function\") {\n        /**\n     * Zod\n     * TODO (next major): Consider wrapping ZodError in ParserError\n     */ return parser.parseAsync;\n    }\n    if (S.isSchema(parser)) {\n        /**\n     * Effect Schema\n     */ return (value)=>S.decodeUnknownPromise(parser)(value).catch((error)=>{\n                throw new ParserError({\n                    cause: Cause.squash(error[Runtime.FiberFailureCauseId])\n                });\n            });\n    }\n    throw new Error(\"Invalid parser\");\n}\n\nclass FileSizeMismatch extends Data.Error {\n    constructor(type, max, actual){\n        const reason = `You uploaded a ${type} file that was ${bytesToFileSize(actual)}, but the limit for that type is ${max}`;\n        super({\n            reason\n        }), this._tag = \"FileSizeMismatch\", this.name = \"FileSizeMismatchError\";\n    }\n}\nclass FileCountMismatch extends Data.Error {\n    constructor(type, boundtype, bound, actual){\n        const reason = `You uploaded ${actual} file(s) of type '${type}', but the ${boundtype} for that type is ${bound}`;\n        super({\n            reason\n        }), this._tag = \"FileCountMismatch\", this.name = \"FileCountMismatchError\";\n    }\n}\n// Verify that the uploaded files doesn't violate the route config,\n// e.g. uploading more videos than allowed, or a file that is larger than allowed.\n// This is double-checked on infra side, but we want to fail early to avoid network latency.\nconst assertFilesMeetConfig = (files, routeConfig)=>Effect.gen(function*() {\n        const counts = {};\n        for (const file of files){\n            const type = yield* matchFileType(file, objectKeys(routeConfig));\n            counts[type] = (counts[type] ?? 0) + 1;\n            const sizeLimit = routeConfig[type]?.maxFileSize;\n            if (!sizeLimit) {\n                return yield* new InvalidRouteConfigError(type, \"maxFileSize\");\n            }\n            const sizeLimitBytes = yield* fileSizeToBytes(sizeLimit);\n            if (file.size > sizeLimitBytes) {\n                return yield* new FileSizeMismatch(type, sizeLimit, file.size);\n            }\n        }\n        for(const _key in counts){\n            const key = _key;\n            const config = routeConfig[key];\n            if (!config) return yield* new InvalidRouteConfigError(key);\n            const count = counts[key];\n            const min = config.minFileCount;\n            const max = config.maxFileCount;\n            if (min > max) {\n                return yield* new UploadThingError({\n                    code: \"BAD_REQUEST\",\n                    message: \"Invalid config during file count - minFileCount > maxFileCount\",\n                    cause: `minFileCount must be less than maxFileCount for key ${key}. got: ${min} > ${max}`\n                });\n            }\n            if (count < min) {\n                return yield* new FileCountMismatch(key, \"minimum\", min, count);\n            }\n            if (count > max) {\n                return yield* new FileCountMismatch(key, \"maximum\", max, count);\n            }\n        }\n        return null;\n    });\nconst extractRouterConfig = (router)=>Effect.forEach(objectKeys(router), (slug)=>Effect.map(fillInputRouteConfig(router[slug].routerConfig), (config)=>({\n                slug,\n                config\n            })));\n\nconst makeRuntime = (fetch, config)=>{\n    const fetchHttpClient = Layer.provideMerge(FetchHttpClient.layer, Layer.succeed(FetchHttpClient.Fetch, fetch));\n    const withRedactedHeaders = Layer.effectDiscard(FiberRef.update(Headers.currentRedactedNames, (_)=>_.concat([\n            \"x-uploadthing-api-key\"\n        ])));\n    const layer = Layer.provide(Layer.mergeAll(withLogFormat, withMinimalLogLevel, fetchHttpClient, withRedactedHeaders), Layer.setConfigProvider(configProvider(config)));\n    return ManagedRuntime.make(layer);\n};\n\nclass AdapterArguments extends Context.Tag(\"uploadthing/AdapterArguments\")() {\n}\nconst makeAdapterHandler = (makeAdapterArgs, toRequest, opts, beAdapter)=>{\n    const managed = makeRuntime(opts.config?.fetch, opts.config);\n    const handle = Effect.promise(()=>managed.runtime().then(HttpApp.toWebHandlerRuntime));\n    const app = (...args)=>Effect.map(Effect.promise(()=>managed.runPromise(createRequestHandler(opts, beAdapter))), Effect.provideServiceEffect(AdapterArguments, makeAdapterArgs(...args)));\n    return async (...args)=>{\n        const result = await handle.pipe(Effect.ap(app(...args)), Effect.ap(toRequest(...args)), Effect.withLogSpan(\"requestHandler\"), managed.runPromise);\n        return result;\n    };\n};\nconst createRequestHandler = (opts, beAdapter)=>Effect.gen(function*() {\n        const isDevelopment = yield* IsDevelopment;\n        const routerConfig = yield* extractRouterConfig(opts.router);\n        const handleDaemon = (()=>{\n            if (opts.config?.handleDaemonPromise) {\n                return opts.config.handleDaemonPromise;\n            }\n            return isDevelopment ? \"void\" : \"await\";\n        })();\n        if (isDevelopment && handleDaemon === \"await\") {\n            return yield* new UploadThingError({\n                code: \"INVALID_SERVER_CONFIG\",\n                message: 'handleDaemonPromise: \"await\" is forbidden in development.'\n            });\n        }\n        const GET = Effect.gen(function*() {\n            return yield* HttpServerResponse.json(routerConfig);\n        });\n        const POST = Effect.gen(function*() {\n            const { \"uploadthing-hook\": uploadthingHook, \"x-uploadthing-package\": fePackage, \"x-uploadthing-version\": clientVersion } = yield* HttpServerRequest.schemaHeaders(S.Struct({\n                \"uploadthing-hook\": UploadThingHook.pipe(S.optional),\n                \"x-uploadthing-package\": S.String.pipe(S.optionalWith({\n                    default: ()=>\"unknown\"\n                })),\n                \"x-uploadthing-version\": S.String.pipe(S.optionalWith({\n                    default: ()=>version\n                }))\n            }));\n            if (clientVersion !== version) {\n                const serverVersion = version;\n                yield* Effect.logWarning(\"Client version mismatch. Things may not work as expected, please sync your versions to ensure compatibility.\").pipe(Effect.annotateLogs({\n                    clientVersion,\n                    serverVersion\n                }));\n            }\n            const { slug, actionType } = yield* HttpRouter.schemaParams(S.Struct({\n                actionType: ActionType.pipe(S.optional),\n                slug: S.String\n            }));\n            const uploadable = opts.router[slug];\n            if (!uploadable) {\n                const msg = `No file route found for slug ${slug}`;\n                yield* Effect.logError(msg);\n                return yield* new UploadThingError({\n                    code: \"NOT_FOUND\",\n                    message: msg\n                });\n            }\n            const { body, fiber } = yield* Match.value({\n                actionType,\n                uploadthingHook\n            }).pipe(Match.when({\n                actionType: \"upload\",\n                uploadthingHook: undefined\n            }, ()=>handleUploadAction({\n                    uploadable,\n                    fePackage,\n                    beAdapter,\n                    slug\n                })), Match.when({\n                actionType: undefined,\n                uploadthingHook: \"callback\"\n            }, ()=>handleCallbackRequest({\n                    uploadable,\n                    fePackage,\n                    beAdapter\n                })), Match.when({\n                actionType: undefined,\n                uploadthingHook: \"error\"\n            }, ()=>handleErrorRequest({\n                    uploadable\n                })), Match.orElse(()=>Effect.succeed({\n                    body: null,\n                    fiber: null\n                })));\n            if (fiber) {\n                yield* Effect.logDebug(\"Running fiber as daemon\").pipe(Effect.annotateLogs(\"handleDaemon\", handleDaemon));\n                if (handleDaemon === \"void\") ; else if (handleDaemon === \"await\") {\n                    yield* fiber.await;\n                } else if (typeof handleDaemon === \"function\") {\n                    handleDaemon(Effect.runPromise(fiber.await));\n                }\n            }\n            yield* Effect.logDebug(\"Sending response\").pipe(Effect.annotateLogs(\"body\", body));\n            return yield* HttpServerResponse.json(body);\n        }).pipe(Effect.catchTags({\n            ParseError: (e)=>HttpServerResponse.json(formatError(new UploadThingError({\n                    code: \"BAD_REQUEST\",\n                    message: \"Invalid input\",\n                    cause: e.message\n                }), opts.router), {\n                    status: 400\n                }),\n            UploadThingError: (e)=>// eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n                HttpServerResponse.json(formatError(e, opts.router), {\n                    status: getStatusCodeFromError(e)\n                })\n        }));\n        const appendResponseHeaders = Effect.map(HttpServerResponse.setHeader(\"x-uploadthing-version\", version));\n        return HttpRouter.empty.pipe(HttpRouter.get(\"*\", GET), HttpRouter.post(\"*\", POST), HttpRouter.use(appendResponseHeaders));\n    }).pipe(Effect.withLogSpan(\"createRequestHandler\"));\nconst handleErrorRequest = (opts)=>Effect.gen(function*() {\n        const { uploadable } = opts;\n        const request = yield* HttpServerRequest.HttpServerRequest;\n        const { apiKey } = yield* UTToken;\n        const verified = yield* verifySignature((yield* request.text), request.headers[\"x-uploadthing-signature\"], apiKey);\n        yield* Effect.logDebug(`Signature verified: ${verified}`);\n        if (!verified) {\n            yield* Effect.logError(\"Invalid signature\");\n            return yield* new UploadThingError({\n                code: \"BAD_REQUEST\",\n                message: \"Invalid signature\"\n            });\n        }\n        const requestInput = yield* HttpServerRequest.schemaBodyJson(S.Struct({\n            fileKey: S.String,\n            error: S.String\n        }));\n        yield* Effect.logDebug(\"Handling error callback request with input:\").pipe(Effect.annotateLogs(\"json\", requestInput));\n        const adapterArgs = yield* AdapterArguments;\n        const fiber = yield* Effect.tryPromise({\n            try: async ()=>uploadable.onUploadError({\n                    ...adapterArgs,\n                    error: new UploadThingError({\n                        code: \"UPLOAD_FAILED\",\n                        message: `Upload failed for ${requestInput.fileKey}: ${requestInput.error}`\n                    }),\n                    fileKey: requestInput.fileKey\n                }),\n            catch: (error)=>new UploadThingError({\n                    code: \"INTERNAL_SERVER_ERROR\",\n                    message: \"Failed to run onUploadError\",\n                    cause: error\n                })\n        }).pipe(Effect.tapError((error)=>Effect.logError(\"Failed to run onUploadError. You probably shouldn't be throwing errors here.\").pipe(Effect.annotateLogs(\"error\", error)))).pipe(Effect.ignoreLogged, Effect.forkDaemon);\n        return {\n            body: null,\n            fiber\n        };\n    }).pipe(Effect.withLogSpan(\"handleErrorRequest\"));\nconst handleCallbackRequest = (opts)=>Effect.gen(function*() {\n        const { uploadable, fePackage, beAdapter } = opts;\n        const request = yield* HttpServerRequest.HttpServerRequest;\n        const { apiKey } = yield* UTToken;\n        const verified = yield* verifySignature((yield* request.text), request.headers[\"x-uploadthing-signature\"], apiKey);\n        yield* Effect.logDebug(`Signature verified: ${verified}`);\n        if (!verified) {\n            yield* Effect.logError(\"Invalid signature\");\n            return yield* new UploadThingError({\n                code: \"BAD_REQUEST\",\n                message: \"Invalid signature\"\n            });\n        }\n        const requestInput = yield* HttpServerRequest.schemaBodyJson(S.Struct({\n            status: S.String,\n            file: UploadedFileData,\n            metadata: S.Record({\n                key: S.String,\n                value: S.Unknown\n            })\n        }));\n        yield* Effect.logDebug(\"Handling callback request with input:\").pipe(Effect.annotateLogs(\"json\", requestInput));\n        /**\n     * Run `.onUploadComplete` as a daemon to prevent the\n     * request from UT to potentially timeout.\n     */ const fiber = yield* Effect.gen(function*() {\n            const adapterArgs = yield* AdapterArguments;\n            const serverData = yield* Effect.tryPromise({\n                try: async ()=>uploadable.onUploadComplete({\n                        ...adapterArgs,\n                        file: requestInput.file,\n                        metadata: requestInput.metadata\n                    }),\n                catch: (error)=>new UploadThingError({\n                        code: \"INTERNAL_SERVER_ERROR\",\n                        message: \"Failed to run onUploadComplete. You probably shouldn't be throwing errors here.\",\n                        cause: error\n                    })\n            });\n            const payload = {\n                fileKey: requestInput.file.key,\n                callbackData: serverData ?? null\n            };\n            yield* Effect.logDebug(\"'onUploadComplete' callback finished. Sending response to UploadThing:\").pipe(Effect.annotateLogs(\"callbackData\", payload));\n            const baseUrl = yield* IngestUrl;\n            const httpClient = (yield* HttpClient.HttpClient).pipe(HttpClient.filterStatusOk);\n            yield* HttpClientRequest.post(`/callback-result`).pipe(HttpClientRequest.prependUrl(baseUrl), HttpClientRequest.setHeaders({\n                \"x-uploadthing-api-key\": Redacted.value(apiKey),\n                \"x-uploadthing-version\": version,\n                \"x-uploadthing-be-adapter\": beAdapter,\n                \"x-uploadthing-fe-package\": fePackage\n            }), HttpClientRequest.bodyJson(payload), Effect.flatMap(httpClient.execute), Effect.tapError(logHttpClientError(\"Failed to register callback result\")), Effect.flatMap(HttpClientResponse.schemaBodyJson(CallbackResultResponse)), Effect.tap(Effect.log(\"Sent callback result to UploadThing\")), Effect.scoped);\n        }).pipe(Effect.ignoreLogged, Effect.forkDaemon);\n        return {\n            body: null,\n            fiber\n        };\n    }).pipe(Effect.withLogSpan(\"handleCallbackRequest\"));\nconst runRouteMiddleware = (opts)=>Effect.gen(function*() {\n        const { json: { files, input }, uploadable } = opts;\n        yield* Effect.logDebug(\"Running middleware\");\n        const adapterArgs = yield* AdapterArguments;\n        const metadata = yield* Effect.tryPromise({\n            try: async ()=>uploadable.middleware({\n                    ...adapterArgs,\n                    input,\n                    files\n                }),\n            catch: (error)=>error instanceof UploadThingError ? error : new UploadThingError({\n                    code: \"INTERNAL_SERVER_ERROR\",\n                    message: \"Failed to run middleware\",\n                    cause: error\n                })\n        });\n        if (metadata[UTFiles] && metadata[UTFiles].length !== files.length) {\n            const msg = `Expected files override to have the same length as original files, got ${metadata[UTFiles].length} but expected ${files.length}`;\n            yield* Effect.logError(msg);\n            return yield* new UploadThingError({\n                code: \"BAD_REQUEST\",\n                message: \"Files override must have the same length as files\",\n                cause: msg\n            });\n        }\n        // Attach customIds from middleware to the files\n        const filesWithCustomIds = yield* Effect.forEach(files, (file, idx)=>Effect.gen(function*() {\n                const theirs = metadata[UTFiles]?.[idx];\n                if (theirs && theirs.size !== file.size) {\n                    yield* Effect.logWarning(\"File size mismatch. Reverting to original size\");\n                }\n                return {\n                    name: theirs?.name ?? file.name,\n                    size: file.size,\n                    type: file.type,\n                    customId: theirs?.customId,\n                    lastModified: theirs?.lastModified ?? Date.now()\n                };\n            }));\n        return {\n            metadata,\n            filesWithCustomIds\n        };\n    }).pipe(Effect.withLogSpan(\"runRouteMiddleware\"));\nconst handleUploadAction = (opts)=>Effect.gen(function*() {\n        const httpClient = (yield* HttpClient.HttpClient).pipe(HttpClient.filterStatusOk);\n        const { uploadable, fePackage, beAdapter, slug } = opts;\n        const json = yield* HttpServerRequest.schemaBodyJson(UploadActionPayload);\n        yield* Effect.logDebug(\"Handling upload request\").pipe(Effect.annotateLogs(\"json\", json));\n        // validate the input\n        yield* Effect.logDebug(\"Parsing user input\");\n        const parsedInput = yield* Effect.tryPromise({\n            try: ()=>getParseFn(uploadable.inputParser)(json.input),\n            catch: (error)=>new UploadThingError({\n                    code: \"BAD_REQUEST\",\n                    message: \"Invalid input\",\n                    cause: error\n                })\n        });\n        yield* Effect.logDebug(\"Input parsed successfully\").pipe(Effect.annotateLogs(\"input\", parsedInput));\n        const { metadata, filesWithCustomIds } = yield* runRouteMiddleware({\n            json: {\n                input: parsedInput,\n                files: json.files\n            },\n            uploadable\n        });\n        yield* Effect.logDebug(\"Parsing route config\").pipe(Effect.annotateLogs(\"routerConfig\", uploadable.routerConfig));\n        const parsedConfig = yield* fillInputRouteConfig(uploadable.routerConfig).pipe(Effect.catchTag(\"InvalidRouteConfig\", (err)=>new UploadThingError({\n                code: \"BAD_REQUEST\",\n                message: \"Invalid route config\",\n                cause: err\n            })));\n        yield* Effect.logDebug(\"Route config parsed successfully\").pipe(Effect.annotateLogs(\"routeConfig\", parsedConfig));\n        yield* Effect.logDebug(\"Validating files meet the config requirements\").pipe(Effect.annotateLogs(\"files\", json.files));\n        yield* assertFilesMeetConfig(json.files, parsedConfig).pipe(Effect.mapError((e)=>new UploadThingError({\n                code: \"BAD_REQUEST\",\n                message: `Invalid config: ${e._tag}`,\n                cause: \"reason\" in e ? e.reason : e.message\n            })));\n        yield* Effect.logDebug(\"Files validated.\");\n        const fileUploadRequests = yield* Effect.forEach(filesWithCustomIds, (file)=>Effect.map(matchFileType(file, objectKeys(parsedConfig)), (type)=>({\n                    name: file.name,\n                    size: file.size,\n                    type: file.type || type,\n                    lastModified: file.lastModified,\n                    customId: file.customId,\n                    contentDisposition: parsedConfig[type]?.contentDisposition ?? \"inline\",\n                    acl: parsedConfig[type]?.acl\n                }))).pipe(Effect.catchTags({\n            /** Shouldn't happen since config is validated above so just dying is fine I think */ InvalidFileType: (e)=>Effect.die(e),\n            UnknownFileType: (e)=>Effect.die(e)\n        }));\n        const routeOptions = uploadable.routeOptions;\n        const { apiKey, appId } = yield* UTToken;\n        const ingestUrl = yield* IngestUrl;\n        const isDev = yield* IsDevelopment;\n        yield* Effect.logDebug(\"Generating presigned URLs\").pipe(Effect.annotateLogs(\"fileUploadRequests\", fileUploadRequests), Effect.annotateLogs(\"ingestUrl\", ingestUrl));\n        const presignedUrls = yield* Effect.forEach(fileUploadRequests, (file)=>Effect.gen(function*() {\n                const key = yield* generateKey(file, appId, routeOptions.getFileHashParts);\n                const url = yield* generateSignedURL(`${ingestUrl}/${key}`, apiKey, {\n                    ttlInSeconds: routeOptions.presignedURLTTL,\n                    data: {\n                        \"x-ut-identifier\": appId,\n                        \"x-ut-file-name\": file.name,\n                        \"x-ut-file-size\": file.size,\n                        \"x-ut-file-type\": file.type,\n                        \"x-ut-slug\": slug,\n                        \"x-ut-custom-id\": file.customId,\n                        \"x-ut-content-disposition\": file.contentDisposition,\n                        \"x-ut-acl\": file.acl\n                    }\n                });\n                return {\n                    url,\n                    key\n                };\n            }), {\n            concurrency: \"unbounded\"\n        });\n        const serverReq = yield* HttpServerRequest.HttpServerRequest;\n        const requestUrl = yield* HttpServerRequest.toURL(serverReq);\n        const devHookRequest = yield* Config.string(\"callbackUrl\").pipe(Config.withDefault(requestUrl.origin + requestUrl.pathname), Effect.map((url)=>HttpClientRequest.post(url).pipe(HttpClientRequest.appendUrlParam(\"slug\", slug))));\n        const metadataRequest = HttpClientRequest.post(\"/route-metadata\").pipe(HttpClientRequest.prependUrl(ingestUrl), HttpClientRequest.setHeaders({\n            \"x-uploadthing-api-key\": Redacted.value(apiKey),\n            \"x-uploadthing-version\": version,\n            \"x-uploadthing-be-adapter\": beAdapter,\n            \"x-uploadthing-fe-package\": fePackage\n        }), HttpClientRequest.bodyJson({\n            fileKeys: presignedUrls.map(({ key })=>key),\n            metadata: metadata,\n            isDev,\n            callbackUrl: devHookRequest.url,\n            callbackSlug: slug,\n            awaitServerData: routeOptions.awaitServerData ?? true\n        }), Effect.flatMap(httpClient.execute));\n        // Send metadata to UT server (non blocking as a daemon)\n        // In dev, keep the stream open and simulate the callback requests as\n        // files complete uploading\n        const fiber = yield* Effect.if(isDev, {\n            onTrue: ()=>metadataRequest.pipe(Effect.tapBoth({\n                    onSuccess: logHttpClientResponse(\"Registered metadata\", {\n                        mixin: \"None\"\n                    }),\n                    onFailure: logHttpClientError(\"Failed to register metadata\")\n                }), HttpClientResponse.stream, handleJsonLineStream(MetadataFetchStreamPart, (chunk)=>devHookRequest.pipe(HttpClientRequest.setHeaders({\n                        \"uploadthing-hook\": chunk.hook,\n                        \"x-uploadthing-signature\": chunk.signature\n                    }), HttpClientRequest.setBody(HttpBody.text(chunk.payload, \"application/json\")), httpClient.execute, Effect.tapBoth({\n                        onSuccess: logHttpClientResponse(\"Successfully forwarded callback request from dev stream\"),\n                        onFailure: logHttpClientError(\"Failed to forward callback request from dev stream\")\n                    }), Effect.annotateLogs(chunk), Effect.asVoid, Effect.ignoreLogged, Effect.scoped))),\n            onFalse: ()=>metadataRequest.pipe(Effect.tapBoth({\n                    onSuccess: logHttpClientResponse(\"Registered metadata\"),\n                    onFailure: logHttpClientError(\"Failed to register metadata\")\n                }), Effect.flatMap(HttpClientResponse.schemaBodyJson(MetadataFetchResponse)), Effect.scoped)\n        }).pipe(Effect.forkDaemon);\n        const presigneds = presignedUrls.map((p, i)=>({\n                url: p.url,\n                key: p.key,\n                name: fileUploadRequests[i].name,\n                customId: fileUploadRequests[i].customId ?? null\n            }));\n        yield* Effect.logInfo(\"Sending presigned URLs to client\").pipe(Effect.annotateLogs(\"presignedUrls\", presigneds));\n        return {\n            body: presigneds,\n            fiber\n        };\n    }).pipe(Effect.withLogSpan(\"handleUploadAction\"));\n\nfunction internalCreateBuilder(initDef = {}) {\n    const _def = {\n        $types: {},\n        // Default router config\n        routerConfig: {\n            image: {\n                maxFileSize: \"4MB\"\n            }\n        },\n        routeOptions: {\n            awaitServerData: true\n        },\n        inputParser: {\n            parseAsync: ()=>Promise.resolve(undefined),\n            _input: undefined,\n            _output: undefined\n        },\n        middleware: ()=>({}),\n        onUploadError: ()=>{\n        // noop\n        },\n        onUploadComplete: ()=>undefined,\n        errorFormatter: initDef.errorFormatter ?? defaultErrorFormatter,\n        // Overload with properties passed in\n        ...initDef\n    };\n    return {\n        input (userParser) {\n            return internalCreateBuilder({\n                ..._def,\n                inputParser: userParser\n            });\n        },\n        middleware (userMiddleware) {\n            return internalCreateBuilder({\n                ..._def,\n                middleware: userMiddleware\n            });\n        },\n        onUploadComplete (userUploadComplete) {\n            return {\n                ..._def,\n                onUploadComplete: userUploadComplete\n            };\n        },\n        onUploadError (userOnUploadError) {\n            return internalCreateBuilder({\n                ..._def,\n                onUploadError: userOnUploadError\n            });\n        }\n    };\n}\nfunction createBuilder(opts) {\n    return (input, config)=>{\n        return internalCreateBuilder({\n            routerConfig: input,\n            routeOptions: config ?? {},\n            ...opts\n        });\n    };\n}\n\nconst createUploadthing = (opts)=>createBuilder(opts);\nconst createRouteHandler = (opts)=>{\n    const handler = makeAdapterHandler((req)=>Effect.succeed({\n            req,\n            res: undefined,\n            event: undefined\n        }), (req)=>Effect.succeed(req), opts, \"nextjs-app\");\n    return {\n        POST: handler,\n        GET: handler\n    };\n};\n\nexport { createRouteHandler, createUploadthing };\n"],"names":[],"mappings":";;;;AAAA;AAMA;AACA;AACA;AANA;AAOA;AAGA;AADA;AADA;AAIA;AADA;AAEA;AAdA;AAeA;AAfA;AAgBA;AAdA;AAFA;AAAA;AAAA;AAAA;AAGA;AAHA;AAAA;AAIA;AAJA;AAiBA;AAjBA;;;;;;;;;;;;;;;;;;;;;;;;;;AAoBA,IAAI,UAAU;AAEd,gJAAE,OAAO,IAAI,wJAAA,CAAA,2BAAwB;AACrC,gJAAE,OAAO,IAAI,wJAAA,CAAA,YAAS;AACtB;;CAEC,GAAG,MAAM,aAAa,gJAAE,OAAO,CAAC;AACjC;;;CAGC,GAAG,MAAM,kBAAkB,gJAAE,OAAO,CAAC,YAAY;AAClD;;;;CAIC,GAAG,MAAM,eAAe,gJAAE,SAAS,CAAC,gJAAE,kBAAkB,EAAE,gJAAE,MAAM,EAAE;IACjE,QAAQ,CAAC,OAAO,IAAI,cAAc,MAAM,CAAC;IACzC,QAAQ,CAAC,OAAO,IAAI,cAAc,MAAM,CAAC;AAC7C;AACA,MAAM,cAAc,gJAAE,MAAM,CAAC;IACzB,QAAQ,gJAAE,QAAQ,CAAC,gJAAE,MAAM,CAAC,IAAI,CAAC,gJAAE,UAAU,CAAC;IAC9C,OAAO,gJAAE,MAAM;IACf,SAAS,gJAAE,aAAa,CAAC,gJAAE,MAAM;IACjC,YAAY,gJAAE,MAAM,CAAC,IAAI,CAAC,gJAAE,YAAY,CAAC;QACrC,SAAS,IAAI;IACjB;AACJ;AACA,MAAM,mBAAmB,gJAAE,oBAAoB,CAAC,IAAI,CAAC,gJAAE,OAAO,CAAC,eAAe,gJAAE,OAAO,CAAC,gJAAE,SAAS,CAAC;AACpG;;;;CAIC,GAAG;;CAEH,GAAG,MAAM,uBAAuB,gJAAE,KAAK,CAAC,kBAAkB;IACvD,MAAM,gJAAE,MAAM;IACd,MAAM,gJAAE,MAAM;IACd,MAAM,gJAAE,MAAM;IACd,cAAc,gJAAE,MAAM,CAAC,IAAI,CAAC,gJAAE,QAAQ;AAC1C;AACA;AACA;;CAEC,GAAG,MAAM,mCAAmC,eAAe,MAAM,CAAC,8BAA8B;IAC7F,UAAU,gJAAE,MAAM,CAAC,gJAAE,MAAM;AAC/B;AACA;AACA;;;;;;CAMC,GAAG,MAAM,yBAAyB,2BAA2B,MAAM,CAAC,oBAAoB;IACrF,KAAK,gJAAE,MAAM;IACb,KAAK,gJAAE,MAAM;IACb,QAAQ,gJAAE,MAAM;IAChB,UAAU,gJAAE,MAAM;AACtB;AACA;AACA;;;;CAIC,GAAG,MAAM,wBAAwB,gJAAE,KAAK,CAAC,mBAAmB;IACzD,KAAK,gJAAE,MAAM;IACb,KAAK,gJAAE,MAAM;IACb,UAAU,gJAAE,MAAM,CAAC,gJAAE,MAAM;IAC3B,MAAM,gJAAE,MAAM;AAClB;AACA;AACA,MAAM,gCAAgC,gJAAE,KAAK,CAAC,2BAA2B;IACrE,SAAS,gJAAE,MAAM;IACjB,WAAW,gJAAE,MAAM;IACnB,MAAM;AACV;AACA;AACA,MAAM,8BAA8B,gJAAE,KAAK,CAAC,yBAAyB;IACjE,IAAI,gJAAE,OAAO;AACjB;AACA;AACA,MAAM,+BAA+B,gJAAE,KAAK,CAAC,0BAA0B;IACnE,IAAI,gJAAE,OAAO;AACjB;AACA;AACA;;;;CAIC,GAAG,MAAM,4BAA4B,gJAAE,KAAK,CAAC,uBAAuB;IACjE,OAAO,gJAAE,KAAK,CAAC;IACf,OAAO,gJAAE,OAAO;AACpB;AACA;AAEA;;;;;;CAMC,GAAG,MAAM,cAAc,wJAAe,OAAO,GAAG,IAAI,CAAC,wJAAe,MAAM,CAAC,IAAI,wJAAe,OAAO,CAAC,IAAI,IAAI,OAAO,OAAO,CAAC,CAAA,GAAA,wJAAA,CAAA,4BAAyB,AAAD,EAClJ,+BAAa,OAAO,CAAC,MAAM;QACvB,WAAW;IACf,KAAK,wJAAe,MAAM,CAAC,gBAAgB,wJAAe,YAAY;AAC1E;;;;CAIC,GAAG,MAAM,iBAAiB,CAAC,UAAU,wJAAe,QAAQ,CAAC,WAAW,CAAC,GAAG,IAAI,CAAC,wJAAe,MAAM,CAAC,IAAI;AAC5G,MAAM,gBAAgB,gJAAO,OAAO,CAAC,SAAS,IAAI,CAAC,gJAAO,MAAM,CAAC,IAAI,gJAAO,OAAO,CAAC,OAAO,YAAY,cAAc,eAAe,WAAW,IAAI,CAAC,gJAAO,GAAG,CAAC,CAAC,IAAI,MAAM,kBAAkB,gJAAO,WAAW,CAAC;AAC/M,MAAM,UAAU,gJAAE,MAAM,CAAC,SAAS,kBAAkB,IAAI,CAAC,gJAAO,SAAS,CAAC;IACtE,aAAa,CAAC,IAAI,IAAI,wJAAA,CAAA,mBAAgB,CAAC;YAC/B,MAAM,EAAE,GAAG,KAAK,gBAAgB,0BAA0B;YAC1D,SAAS,EAAE,GAAG,KAAK,gBAAgB,0HAA0H;YAC7J,OAAO;QACX;AACR;AACA,gJAAO,MAAM,CAAC,UAAU,IAAI,CAAC,gJAAO,WAAW,CAAC,gCAAgC,gJAAO,UAAU,CAAC,CAAC,IAAI,IAAI,IAAI,KAAK,gJAAO,GAAG,CAAC,CAAC,MAAM,IAAI,IAAI,CAAC,OAAO,CAAC,OAAO;AAC9J,MAAM,YAAY,gJAAO,GAAG,CAAC;IACzB,MAAM,EAAE,OAAO,EAAE,UAAU,EAAE,GAAG,OAAO;IACvC,MAAM,SAAS,OAAO,CAAC,EAAE,EAAE,0CAA0C;IACrE,OAAO,OAAO,gJAAO,MAAM,CAAC,aAAa,IAAI,CAAC,gJAAO,WAAW,CAAC,CAAC,QAAQ,EAAE,OAAO,CAAC,EAAE,YAAY,GAAG,gJAAO,UAAU,CAAC,CAAC,IAAI,IAAI,IAAI,KAAK,gJAAO,GAAG,CAAC,CAAC,MAAM,IAAI,IAAI,CAAC,OAAO,CAAC,OAAO;AACvL;AAEA,SAAS,sBAAsB,KAAK;IAChC,OAAO;QACH,SAAS,MAAM,OAAO;IAC1B;AACJ;AACA,SAAS,YAAY,KAAK,EAAE,MAAM;IAC9B,MAAM,iBAAiB,MAAM,CAAC,OAAO,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,kBAAkB;IACzE,OAAO,eAAe;AAC1B;AAEA,MAAM,uBAAuB,CAAC,QAAQ,UAAU,CAAC;QACzC,IAAI,MAAM;QACV,OAAO,OAAO,IAAI,CAAC,gJAAO,UAAU,IAAI,gJAAO,SAAS,CAAC,CAAC,QAAQ,gJAAO,GAAG,CAAC;gBACrE,OAAO;gBACP,2BAA2B;gBAC3B,MAAM,QAAQ,IAAI,KAAK,CAAC;gBACxB,MAAM,cAAc,EAAE;gBACtB,KAAK,MAAM,QAAQ,MAAM;oBACrB,IAAI;wBACA,iCAAiC;wBACjC,YAAY,IAAI,CAAC,KAAK,KAAK,CAAC;wBAC5B,sCAAsC;wBACtC,MAAM,IAAI,KAAK,CAAC,KAAK,MAAM,GAAG;oBAClC,EAAE,OAAO;oBACT,EAAE;oBACF;gBACJ;gBACA,OAAO,gJAAO,QAAQ,CAAC,mBAAmB,IAAI,CAAC,gJAAO,YAAY,CAAC,SAAS,QAAQ,gJAAO,YAAY,CAAC,gBAAgB,cAAc,gJAAO,YAAY,CAAC,OAAO;gBACjK,OAAO;YACX,KAAK,gJAAO,SAAS,CAAC,gJAAE,aAAa,CAAC,gJAAE,KAAK,CAAC,WAAW,gJAAO,SAAS,CAAC,gJAAO,OAAO,CAAC,CAAC,OAAO,QAAQ,SAAS,gJAAO,QAAQ,EAAE,gJAAO,WAAW,CAAC;IAC9J;AAEJ,MAAM,sBAAsB,gJAAO,QAAQ,CAAC,YAAY,IAAI,CAAC,gJAAO,WAAW,CAAC,kJAAS,IAAI,GAAG,gJAAO,OAAO,CAAC,CAAC,QAAQ,gJAAO,eAAe,CAAC,SAAS,gJAAO,QAAQ,CAAC,CAAC,IAAI,gJAAO,QAAQ,CAAC,qBAAqB,IAAI,CAAC,gJAAO,YAAY,CAAC,SAAS,MAAM,gJAAO,QAAQ,CAAC,eAAe,CAAC,IAAI,IAAI,wJAAA,CAAA,mBAAgB,CAAC;QAC3S,MAAM;QACN,SAAS;QACT,OAAO;IACX,KAAK,+IAAM,YAAY;AAC3B,MAAM,YAAY,gJAAO,OAAO,CAAC,QAAQ,UAAU,cAAc,UAAU;AAC3E,MAAM,gBAAgB,gJAAO,GAAG,CAAC;IAC7B,MAAM,QAAQ,OAAO;IACrB,MAAM,YAAY,OAAO,UAAU,IAAI,CAAC,gJAAO,WAAW,CAAC,QAAQ,WAAW;IAC9E,OAAO,+IAAM,CAAC,UAAU;AAC5B,GAAG,IAAI,CAAC,gJAAO,QAAQ,CAAC,eAAe,CAAC,IAAI,IAAI,wJAAA,CAAA,mBAAgB,CAAC;QACzD,MAAM;QACN,SAAS;QACT,OAAO;IACX,KAAK,+IAAM,YAAY;AAC3B,MAAM,wBAAwB,CAAC,SAAS;IACpC,MAAM,QAAQ,MAAM,SAAS;IAC7B,MAAM,QAAQ,kJAAS,WAAW,CAAC,MAAM,SAAS;IAClD,OAAO,CAAC,WAAW,gJAAO,OAAO,CAAC,UAAU,SAAS,QAAQ,CAAC,MAAM,GAAG,gJAAO,IAAI,EAAE,IAAI,gJAAO,YAAY,CAAC,OAAO,GAAG,QAAQ,EAAE,EAAE,SAAS,MAAM,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,gJAAO,YAAY,CAAC,YAAY;AAC/L;AACA,MAAM,qBAAqB,CAAC,UAAU,CAAC,MAAM,IAAI,IAAI,KAAK,kBAAkB,sBAAsB,SAAS;YAC/F,OAAO;QACX,GAAG,IAAI,QAAQ,IAAI,gJAAO,QAAQ,CAAC,SAAS,IAAI,CAAC,gJAAO,YAAY,CAAC,SAAS;AAEtF,MAAM,oBAAoB,8IAAK,WAAW,CAAC;IACvC,YAAY,GAAG,IAAI,CAAC;QAChB,KAAK,IAAI,OAAO,IAAI,CAAC,OAAO,GAAG;IACnC;AACJ;AACA,SAAS,WAAW,MAAM;IACtB,IAAI,eAAe,QAAQ;QACvB;;KAEH,GAAG,OAAO,OAAO;YACV,MAAM,SAAS,MAAM,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC;YAClD,IAAI,OAAO,MAAM,EAAE;gBACf,MAAM,IAAI,YAAY;oBAClB,OAAO,OAAO,MAAM;gBACxB;YACJ;YACA,OAAO,OAAO,KAAK;QACvB;IACJ;IACA,IAAI,gBAAgB,UAAU,OAAO,OAAO,UAAU,KAAK,YAAY;QACnE;;;KAGH,GAAG,OAAO,OAAO,UAAU;IAC5B;IACA,IAAI,gJAAE,QAAQ,CAAC,SAAS;QACpB;;KAEH,GAAG,OAAO,CAAC,QAAQ,gJAAE,oBAAoB,CAAC,QAAQ,OAAO,KAAK,CAAC,CAAC;gBACrD,MAAM,IAAI,YAAY;oBAClB,OAAO,+IAAM,MAAM,CAAC,KAAK,CAAC,iJAAQ,mBAAmB,CAAC;gBAC1D;YACJ;IACR;IACA,MAAM,IAAI,MAAM;AACpB;AAEA,MAAM,yBAAyB,8IAAK,KAAK;IACrC,YAAY,IAAI,EAAE,GAAG,EAAE,MAAM,CAAC;QAC1B,MAAM,SAAS,CAAC,eAAe,EAAE,KAAK,eAAe,EAAE,CAAA,GAAA,wJAAA,CAAA,kBAAe,AAAD,EAAE,QAAQ,iCAAiC,EAAE,KAAK;QACvH,KAAK,CAAC;YACF;QACJ,IAAI,IAAI,CAAC,IAAI,GAAG,oBAAoB,IAAI,CAAC,IAAI,GAAG;IACpD;AACJ;AACA,MAAM,0BAA0B,8IAAK,KAAK;IACtC,YAAY,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,MAAM,CAAC;QACvC,MAAM,SAAS,CAAC,aAAa,EAAE,OAAO,kBAAkB,EAAE,KAAK,WAAW,EAAE,UAAU,kBAAkB,EAAE,OAAO;QACjH,KAAK,CAAC;YACF;QACJ,IAAI,IAAI,CAAC,IAAI,GAAG,qBAAqB,IAAI,CAAC,IAAI,GAAG;IACrD;AACJ;AACA,mEAAmE;AACnE,kFAAkF;AAClF,4FAA4F;AAC5F,MAAM,wBAAwB,CAAC,OAAO,cAAc,gJAAO,GAAG,CAAC;QACvD,MAAM,SAAS,CAAC;QAChB,KAAK,MAAM,QAAQ,MAAM;YACrB,MAAM,OAAO,OAAO,CAAA,GAAA,wJAAA,CAAA,gBAAa,AAAD,EAAE,MAAM,CAAA,GAAA,wJAAA,CAAA,aAAU,AAAD,EAAE;YACnD,MAAM,CAAC,KAAK,GAAG,CAAC,MAAM,CAAC,KAAK,IAAI,CAAC,IAAI;YACrC,MAAM,YAAY,WAAW,CAAC,KAAK,EAAE;YACrC,IAAI,CAAC,WAAW;gBACZ,OAAO,OAAO,IAAI,wJAAA,CAAA,0BAAuB,CAAC,MAAM;YACpD;YACA,MAAM,iBAAiB,OAAO,CAAA,GAAA,wJAAA,CAAA,kBAAe,AAAD,EAAE;YAC9C,IAAI,KAAK,IAAI,GAAG,gBAAgB;gBAC5B,OAAO,OAAO,IAAI,iBAAiB,MAAM,WAAW,KAAK,IAAI;YACjE;QACJ;QACA,IAAI,MAAM,QAAQ,OAAO;YACrB,MAAM,MAAM;YACZ,MAAM,SAAS,WAAW,CAAC,IAAI;YAC/B,IAAI,CAAC,QAAQ,OAAO,OAAO,IAAI,wJAAA,CAAA,0BAAuB,CAAC;YACvD,MAAM,QAAQ,MAAM,CAAC,IAAI;YACzB,MAAM,MAAM,OAAO,YAAY;YAC/B,MAAM,MAAM,OAAO,YAAY;YAC/B,IAAI,MAAM,KAAK;gBACX,OAAO,OAAO,IAAI,wJAAA,CAAA,mBAAgB,CAAC;oBAC/B,MAAM;oBACN,SAAS;oBACT,OAAO,CAAC,oDAAoD,EAAE,IAAI,OAAO,EAAE,IAAI,GAAG,EAAE,KAAK;gBAC7F;YACJ;YACA,IAAI,QAAQ,KAAK;gBACb,OAAO,OAAO,IAAI,kBAAkB,KAAK,WAAW,KAAK;YAC7D;YACA,IAAI,QAAQ,KAAK;gBACb,OAAO,OAAO,IAAI,kBAAkB,KAAK,WAAW,KAAK;YAC7D;QACJ;QACA,OAAO;IACX;AACJ,MAAM,sBAAsB,CAAC,SAAS,gJAAO,OAAO,CAAC,CAAA,GAAA,wJAAA,CAAA,aAAU,AAAD,EAAE,SAAS,CAAC,OAAO,gJAAO,GAAG,CAAC,CAAA,GAAA,wJAAA,CAAA,uBAAoB,AAAD,EAAE,MAAM,CAAC,KAAK,CAAC,YAAY,GAAG,CAAC,SAAS,CAAC;gBACxI;gBACA;YACJ,CAAC;AAEb,MAAM,cAAc,CAAC,OAAO;IACxB,MAAM,kBAAkB,+IAAM,YAAY,CAAC,iNAAA,CAAA,kBAAe,CAAC,KAAK,EAAE,+IAAM,OAAO,CAAC,iNAAA,CAAA,kBAAe,CAAC,KAAK,EAAE;IACvG,MAAM,sBAAsB,+IAAM,aAAa,CAAC,kJAAS,MAAM,CAAC,iMAAA,CAAA,UAAO,CAAC,oBAAoB,EAAE,CAAC,IAAI,EAAE,MAAM,CAAC;YACpG;SACH;IACL,MAAM,QAAQ,+IAAM,OAAO,CAAC,+IAAM,QAAQ,CAAC,eAAe,qBAAqB,iBAAiB,sBAAsB,+IAAM,iBAAiB,CAAC,eAAe;IAC7J,OAAO,wJAAe,IAAI,CAAC;AAC/B;AAEA,MAAM,yBAAyB,iJAAQ,GAAG,CAAC;AAC3C;AACA,MAAM,qBAAqB,CAAC,iBAAiB,WAAW,MAAM;IAC1D,MAAM,UAAU,YAAY,KAAK,MAAM,EAAE,OAAO,KAAK,MAAM;IAC3D,MAAM,SAAS,gJAAO,OAAO,CAAC,IAAI,QAAQ,OAAO,GAAG,IAAI,CAAC,iMAAA,CAAA,UAAO,CAAC,mBAAmB;IACpF,MAAM,MAAM,CAAC,GAAG,OAAO,gJAAO,GAAG,CAAC,gJAAO,OAAO,CAAC,IAAI,QAAQ,UAAU,CAAC,qBAAqB,MAAM,cAAc,gJAAO,oBAAoB,CAAC,kBAAkB,mBAAmB;IAClL,OAAO,OAAO,GAAG;QACb,MAAM,SAAS,MAAM,OAAO,IAAI,CAAC,gJAAO,EAAE,CAAC,OAAO,QAAQ,gJAAO,EAAE,CAAC,aAAa,QAAQ,gJAAO,WAAW,CAAC,mBAAmB,QAAQ,UAAU;QACjJ,OAAO;IACX;AACJ;AACA,MAAM,uBAAuB,CAAC,MAAM,YAAY,gJAAO,GAAG,CAAC;QACnD,MAAM,gBAAgB,OAAO;QAC7B,MAAM,eAAe,OAAO,oBAAoB,KAAK,MAAM;QAC3D,MAAM,eAAe,CAAC;YAClB,IAAI,KAAK,MAAM,EAAE,qBAAqB;gBAClC,OAAO,KAAK,MAAM,CAAC,mBAAmB;YAC1C;YACA,OAAO,gBAAgB,SAAS;QACpC,CAAC;QACD,IAAI,iBAAiB,iBAAiB,SAAS;YAC3C,OAAO,OAAO,IAAI,wJAAA,CAAA,mBAAgB,CAAC;gBAC/B,MAAM;gBACN,SAAS;YACb;QACJ;QACA,MAAM,MAAM,gJAAO,GAAG,CAAC;YACnB,OAAO,OAAO,uNAAA,CAAA,qBAAkB,CAAC,IAAI,CAAC;QAC1C;QACA,MAAM,OAAO,gJAAO,GAAG,CAAC;YACpB,MAAM,EAAE,oBAAoB,eAAe,EAAE,yBAAyB,SAAS,EAAE,yBAAyB,aAAa,EAAE,GAAG,OAAO,qNAAA,CAAA,oBAAiB,CAAC,aAAa,CAAC,gJAAE,MAAM,CAAC;gBACxK,oBAAoB,gBAAgB,IAAI,CAAC,gJAAE,QAAQ;gBACnD,yBAAyB,gJAAE,MAAM,CAAC,IAAI,CAAC,gJAAE,YAAY,CAAC;oBAClD,SAAS,IAAI;gBACjB;gBACA,yBAAyB,gJAAE,MAAM,CAAC,IAAI,CAAC,gJAAE,YAAY,CAAC;oBAClD,SAAS,IAAI;gBACjB;YACJ;YACA,IAAI,kBAAkB,SAAS;gBAC3B,MAAM,gBAAgB;gBACtB,OAAO,gJAAO,UAAU,CAAC,gHAAgH,IAAI,CAAC,gJAAO,YAAY,CAAC;oBAC9J;oBACA;gBACJ;YACJ;YACA,MAAM,EAAE,IAAI,EAAE,UAAU,EAAE,GAAG,OAAO,uMAAA,CAAA,aAAU,CAAC,YAAY,CAAC,gJAAE,MAAM,CAAC;gBACjE,YAAY,WAAW,IAAI,CAAC,gJAAE,QAAQ;gBACtC,MAAM,gJAAE,MAAM;YAClB;YACA,MAAM,aAAa,KAAK,MAAM,CAAC,KAAK;YACpC,IAAI,CAAC,YAAY;gBACb,MAAM,MAAM,CAAC,6BAA6B,EAAE,MAAM;gBAClD,OAAO,gJAAO,QAAQ,CAAC;gBACvB,OAAO,OAAO,IAAI,wJAAA,CAAA,mBAAgB,CAAC;oBAC/B,MAAM;oBACN,SAAS;gBACb;YACJ;YACA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,OAAO,+IAAM,KAAK,CAAC;gBACvC;gBACA;YACJ,GAAG,IAAI,CAAC,+IAAM,IAAI,CAAC;gBACf,YAAY;gBACZ,iBAAiB;YACrB,GAAG,IAAI,mBAAmB;oBAClB;oBACA;oBACA;oBACA;gBACJ,KAAK,+IAAM,IAAI,CAAC;gBAChB,YAAY;gBACZ,iBAAiB;YACrB,GAAG,IAAI,sBAAsB;oBACrB;oBACA;oBACA;gBACJ,KAAK,+IAAM,IAAI,CAAC;gBAChB,YAAY;gBACZ,iBAAiB;YACrB,GAAG,IAAI,mBAAmB;oBAClB;gBACJ,KAAK,+IAAM,MAAM,CAAC,IAAI,gJAAO,OAAO,CAAC;oBACjC,MAAM;oBACN,OAAO;gBACX;YACJ,IAAI,OAAO;gBACP,OAAO,gJAAO,QAAQ,CAAC,2BAA2B,IAAI,CAAC,gJAAO,YAAY,CAAC,gBAAgB;gBAC3F,IAAI,iBAAiB;qBAAe,IAAI,iBAAiB,SAAS;oBAC9D,OAAO,MAAM,KAAK;gBACtB,OAAO,IAAI,OAAO,iBAAiB,YAAY;oBAC3C,aAAa,gJAAO,UAAU,CAAC,MAAM,KAAK;gBAC9C;YACJ;YACA,OAAO,gJAAO,QAAQ,CAAC,oBAAoB,IAAI,CAAC,gJAAO,YAAY,CAAC,QAAQ;YAC5E,OAAO,OAAO,uNAAA,CAAA,qBAAkB,CAAC,IAAI,CAAC;QAC1C,GAAG,IAAI,CAAC,gJAAO,SAAS,CAAC;YACrB,YAAY,CAAC,IAAI,uNAAA,CAAA,qBAAkB,CAAC,IAAI,CAAC,YAAY,IAAI,wJAAA,CAAA,mBAAgB,CAAC;oBAClE,MAAM;oBACN,SAAS;oBACT,OAAO,EAAE,OAAO;gBACpB,IAAI,KAAK,MAAM,GAAG;oBACd,QAAQ;gBACZ;YACJ,kBAAkB,CAAC,IACf,uNAAA,CAAA,qBAAkB,CAAC,IAAI,CAAC,YAAY,GAAG,KAAK,MAAM,GAAG;oBACjD,QAAQ,CAAA,GAAA,wJAAA,CAAA,yBAAsB,AAAD,EAAE;gBACnC;QACR;QACA,MAAM,wBAAwB,gJAAO,GAAG,CAAC,uNAAA,CAAA,qBAAkB,CAAC,SAAS,CAAC,yBAAyB;QAC/F,OAAO,uMAAA,CAAA,aAAU,CAAC,KAAK,CAAC,IAAI,CAAC,uMAAA,CAAA,aAAU,CAAC,GAAG,CAAC,KAAK,MAAM,uMAAA,CAAA,aAAU,CAAC,IAAI,CAAC,KAAK,OAAO,uMAAA,CAAA,aAAU,CAAC,GAAG,CAAC;IACtG,GAAG,IAAI,CAAC,gJAAO,WAAW,CAAC;AAC/B,MAAM,qBAAqB,CAAC,OAAO,gJAAO,GAAG,CAAC;QACtC,MAAM,EAAE,UAAU,EAAE,GAAG;QACvB,MAAM,UAAU,OAAO,qNAAA,CAAA,oBAAiB,CAAC,iBAAiB;QAC1D,MAAM,EAAE,MAAM,EAAE,GAAG,OAAO;QAC1B,MAAM,WAAW,OAAO,CAAA,GAAA,wJAAA,CAAA,kBAAe,AAAD,EAAE,CAAC,OAAO,QAAQ,IAAI,GAAG,QAAQ,OAAO,CAAC,0BAA0B,EAAE;QAC3G,OAAO,gJAAO,QAAQ,CAAC,CAAC,oBAAoB,EAAE,UAAU;QACxD,IAAI,CAAC,UAAU;YACX,OAAO,gJAAO,QAAQ,CAAC;YACvB,OAAO,OAAO,IAAI,wJAAA,CAAA,mBAAgB,CAAC;gBAC/B,MAAM;gBACN,SAAS;YACb;QACJ;QACA,MAAM,eAAe,OAAO,qNAAA,CAAA,oBAAiB,CAAC,cAAc,CAAC,gJAAE,MAAM,CAAC;YAClE,SAAS,gJAAE,MAAM;YACjB,OAAO,gJAAE,MAAM;QACnB;QACA,OAAO,gJAAO,QAAQ,CAAC,+CAA+C,IAAI,CAAC,gJAAO,YAAY,CAAC,QAAQ;QACvG,MAAM,cAAc,OAAO;QAC3B,MAAM,QAAQ,OAAO,gJAAO,UAAU,CAAC;YACnC,KAAK,UAAU,WAAW,aAAa,CAAC;oBAChC,GAAG,WAAW;oBACd,OAAO,IAAI,wJAAA,CAAA,mBAAgB,CAAC;wBACxB,MAAM;wBACN,SAAS,CAAC,kBAAkB,EAAE,aAAa,OAAO,CAAC,EAAE,EAAE,aAAa,KAAK,EAAE;oBAC/E;oBACA,SAAS,aAAa,OAAO;gBACjC;YACJ,OAAO,CAAC,QAAQ,IAAI,wJAAA,CAAA,mBAAgB,CAAC;oBAC7B,MAAM;oBACN,SAAS;oBACT,OAAO;gBACX;QACR,GAAG,IAAI,CAAC,gJAAO,QAAQ,CAAC,CAAC,QAAQ,gJAAO,QAAQ,CAAC,gFAAgF,IAAI,CAAC,gJAAO,YAAY,CAAC,SAAS,UAAU,IAAI,CAAC,gJAAO,YAAY,EAAE,gJAAO,UAAU;QACxN,OAAO;YACH,MAAM;YACN;QACJ;IACJ,GAAG,IAAI,CAAC,gJAAO,WAAW,CAAC;AAC/B,MAAM,wBAAwB,CAAC,OAAO,gJAAO,GAAG,CAAC;QACzC,MAAM,EAAE,UAAU,EAAE,SAAS,EAAE,SAAS,EAAE,GAAG;QAC7C,MAAM,UAAU,OAAO,qNAAA,CAAA,oBAAiB,CAAC,iBAAiB;QAC1D,MAAM,EAAE,MAAM,EAAE,GAAG,OAAO;QAC1B,MAAM,WAAW,OAAO,CAAA,GAAA,wJAAA,CAAA,kBAAe,AAAD,EAAE,CAAC,OAAO,QAAQ,IAAI,GAAG,QAAQ,OAAO,CAAC,0BAA0B,EAAE;QAC3G,OAAO,gJAAO,QAAQ,CAAC,CAAC,oBAAoB,EAAE,UAAU;QACxD,IAAI,CAAC,UAAU;YACX,OAAO,gJAAO,QAAQ,CAAC;YACvB,OAAO,OAAO,IAAI,wJAAA,CAAA,mBAAgB,CAAC;gBAC/B,MAAM;gBACN,SAAS;YACb;QACJ;QACA,MAAM,eAAe,OAAO,qNAAA,CAAA,oBAAiB,CAAC,cAAc,CAAC,gJAAE,MAAM,CAAC;YAClE,QAAQ,gJAAE,MAAM;YAChB,MAAM;YACN,UAAU,gJAAE,MAAM,CAAC;gBACf,KAAK,gJAAE,MAAM;gBACb,OAAO,gJAAE,OAAO;YACpB;QACJ;QACA,OAAO,gJAAO,QAAQ,CAAC,yCAAyC,IAAI,CAAC,gJAAO,YAAY,CAAC,QAAQ;QACjG;;;KAGH,GAAG,MAAM,QAAQ,OAAO,gJAAO,GAAG,CAAC;YAC5B,MAAM,cAAc,OAAO;YAC3B,MAAM,aAAa,OAAO,gJAAO,UAAU,CAAC;gBACxC,KAAK,UAAU,WAAW,gBAAgB,CAAC;wBACnC,GAAG,WAAW;wBACd,MAAM,aAAa,IAAI;wBACvB,UAAU,aAAa,QAAQ;oBACnC;gBACJ,OAAO,CAAC,QAAQ,IAAI,wJAAA,CAAA,mBAAgB,CAAC;wBAC7B,MAAM;wBACN,SAAS;wBACT,OAAO;oBACX;YACR;YACA,MAAM,UAAU;gBACZ,SAAS,aAAa,IAAI,CAAC,GAAG;gBAC9B,cAAc,cAAc;YAChC;YACA,OAAO,gJAAO,QAAQ,CAAC,0EAA0E,IAAI,CAAC,gJAAO,YAAY,CAAC,gBAAgB;YAC1I,MAAM,UAAU,OAAO;YACvB,MAAM,aAAa,CAAC,OAAO,uMAAA,CAAA,aAAU,CAAC,UAAU,EAAE,IAAI,CAAC,uMAAA,CAAA,aAAU,CAAC,cAAc;YAChF,OAAO,qNAAA,CAAA,oBAAiB,CAAC,IAAI,CAAC,CAAC,gBAAgB,CAAC,EAAE,IAAI,CAAC,qNAAA,CAAA,oBAAiB,CAAC,UAAU,CAAC,UAAU,qNAAA,CAAA,oBAAiB,CAAC,UAAU,CAAC;gBACvH,yBAAyB,kJAAS,KAAK,CAAC;gBACxC,yBAAyB;gBACzB,4BAA4B;gBAC5B,4BAA4B;YAChC,IAAI,qNAAA,CAAA,oBAAiB,CAAC,QAAQ,CAAC,UAAU,gJAAO,OAAO,CAAC,WAAW,OAAO,GAAG,gJAAO,QAAQ,CAAC,mBAAmB,wCAAwC,gJAAO,OAAO,CAAC,uNAAA,CAAA,qBAAkB,CAAC,cAAc,CAAC,0BAA0B,gJAAO,GAAG,CAAC,gJAAO,GAAG,CAAC,yCAAyC,gJAAO,MAAM;QACnT,GAAG,IAAI,CAAC,gJAAO,YAAY,EAAE,gJAAO,UAAU;QAC9C,OAAO;YACH,MAAM;YACN;QACJ;IACJ,GAAG,IAAI,CAAC,gJAAO,WAAW,CAAC;AAC/B,MAAM,qBAAqB,CAAC,OAAO,gJAAO,GAAG,CAAC;QACtC,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,EAAE,UAAU,EAAE,GAAG;QAC/C,OAAO,gJAAO,QAAQ,CAAC;QACvB,MAAM,cAAc,OAAO;QAC3B,MAAM,WAAW,OAAO,gJAAO,UAAU,CAAC;YACtC,KAAK,UAAU,WAAW,UAAU,CAAC;oBAC7B,GAAG,WAAW;oBACd;oBACA;gBACJ;YACJ,OAAO,CAAC,QAAQ,iBAAiB,wJAAA,CAAA,mBAAgB,GAAG,QAAQ,IAAI,wJAAA,CAAA,mBAAgB,CAAC;oBACzE,MAAM;oBACN,SAAS;oBACT,OAAO;gBACX;QACR;QACA,IAAI,QAAQ,CAAC,gJAAA,CAAA,UAAO,CAAC,IAAI,QAAQ,CAAC,gJAAA,CAAA,UAAO,CAAC,CAAC,MAAM,KAAK,MAAM,MAAM,EAAE;YAChE,MAAM,MAAM,CAAC,uEAAuE,EAAE,QAAQ,CAAC,gJAAA,CAAA,UAAO,CAAC,CAAC,MAAM,CAAC,cAAc,EAAE,MAAM,MAAM,EAAE;YAC7I,OAAO,gJAAO,QAAQ,CAAC;YACvB,OAAO,OAAO,IAAI,wJAAA,CAAA,mBAAgB,CAAC;gBAC/B,MAAM;gBACN,SAAS;gBACT,OAAO;YACX;QACJ;QACA,gDAAgD;QAChD,MAAM,qBAAqB,OAAO,gJAAO,OAAO,CAAC,OAAO,CAAC,MAAM,MAAM,gJAAO,GAAG,CAAC;gBACxE,MAAM,SAAS,QAAQ,CAAC,gJAAA,CAAA,UAAO,CAAC,EAAE,CAAC,IAAI;gBACvC,IAAI,UAAU,OAAO,IAAI,KAAK,KAAK,IAAI,EAAE;oBACrC,OAAO,gJAAO,UAAU,CAAC;gBAC7B;gBACA,OAAO;oBACH,MAAM,QAAQ,QAAQ,KAAK,IAAI;oBAC/B,MAAM,KAAK,IAAI;oBACf,MAAM,KAAK,IAAI;oBACf,UAAU,QAAQ;oBAClB,cAAc,QAAQ,gBAAgB,KAAK,GAAG;gBAClD;YACJ;QACJ,OAAO;YACH;YACA;QACJ;IACJ,GAAG,IAAI,CAAC,gJAAO,WAAW,CAAC;AAC/B,MAAM,qBAAqB,CAAC,OAAO,gJAAO,GAAG,CAAC;QACtC,MAAM,aAAa,CAAC,OAAO,uMAAA,CAAA,aAAU,CAAC,UAAU,EAAE,IAAI,CAAC,uMAAA,CAAA,aAAU,CAAC,cAAc;QAChF,MAAM,EAAE,UAAU,EAAE,SAAS,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG;QACnD,MAAM,OAAO,OAAO,qNAAA,CAAA,oBAAiB,CAAC,cAAc,CAAC;QACrD,OAAO,gJAAO,QAAQ,CAAC,2BAA2B,IAAI,CAAC,gJAAO,YAAY,CAAC,QAAQ;QACnF,qBAAqB;QACrB,OAAO,gJAAO,QAAQ,CAAC;QACvB,MAAM,cAAc,OAAO,gJAAO,UAAU,CAAC;YACzC,KAAK,IAAI,WAAW,WAAW,WAAW,EAAE,KAAK,KAAK;YACtD,OAAO,CAAC,QAAQ,IAAI,wJAAA,CAAA,mBAAgB,CAAC;oBAC7B,MAAM;oBACN,SAAS;oBACT,OAAO;gBACX;QACR;QACA,OAAO,gJAAO,QAAQ,CAAC,6BAA6B,IAAI,CAAC,gJAAO,YAAY,CAAC,SAAS;QACtF,MAAM,EAAE,QAAQ,EAAE,kBAAkB,EAAE,GAAG,OAAO,mBAAmB;YAC/D,MAAM;gBACF,OAAO;gBACP,OAAO,KAAK,KAAK;YACrB;YACA;QACJ;QACA,OAAO,gJAAO,QAAQ,CAAC,wBAAwB,IAAI,CAAC,gJAAO,YAAY,CAAC,gBAAgB,WAAW,YAAY;QAC/G,MAAM,eAAe,OAAO,CAAA,GAAA,wJAAA,CAAA,uBAAoB,AAAD,EAAE,WAAW,YAAY,EAAE,IAAI,CAAC,gJAAO,QAAQ,CAAC,sBAAsB,CAAC,MAAM,IAAI,wJAAA,CAAA,mBAAgB,CAAC;gBACzI,MAAM;gBACN,SAAS;gBACT,OAAO;YACX;QACJ,OAAO,gJAAO,QAAQ,CAAC,oCAAoC,IAAI,CAAC,gJAAO,YAAY,CAAC,eAAe;QACnG,OAAO,gJAAO,QAAQ,CAAC,iDAAiD,IAAI,CAAC,gJAAO,YAAY,CAAC,SAAS,KAAK,KAAK;QACpH,OAAO,sBAAsB,KAAK,KAAK,EAAE,cAAc,IAAI,CAAC,gJAAO,QAAQ,CAAC,CAAC,IAAI,IAAI,wJAAA,CAAA,mBAAgB,CAAC;gBAC9F,MAAM;gBACN,SAAS,CAAC,gBAAgB,EAAE,EAAE,IAAI,EAAE;gBACpC,OAAO,YAAY,IAAI,EAAE,MAAM,GAAG,EAAE,OAAO;YAC/C;QACJ,OAAO,gJAAO,QAAQ,CAAC;QACvB,MAAM,qBAAqB,OAAO,gJAAO,OAAO,CAAC,oBAAoB,CAAC,OAAO,gJAAO,GAAG,CAAC,CAAA,GAAA,wJAAA,CAAA,gBAAa,AAAD,EAAE,MAAM,CAAA,GAAA,wJAAA,CAAA,aAAU,AAAD,EAAE,gBAAgB,CAAC,OAAO,CAAC;oBACpI,MAAM,KAAK,IAAI;oBACf,MAAM,KAAK,IAAI;oBACf,MAAM,KAAK,IAAI,IAAI;oBACnB,cAAc,KAAK,YAAY;oBAC/B,UAAU,KAAK,QAAQ;oBACvB,oBAAoB,YAAY,CAAC,KAAK,EAAE,sBAAsB;oBAC9D,KAAK,YAAY,CAAC,KAAK,EAAE;gBAC7B,CAAC,IAAI,IAAI,CAAC,gJAAO,SAAS,CAAC;YAC/B,mFAAmF,GAAG,iBAAiB,CAAC,IAAI,gJAAO,GAAG,CAAC;YACvH,iBAAiB,CAAC,IAAI,gJAAO,GAAG,CAAC;QACrC;QACA,MAAM,eAAe,WAAW,YAAY;QAC5C,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,GAAG,OAAO;QACjC,MAAM,YAAY,OAAO;QACzB,MAAM,QAAQ,OAAO;QACrB,OAAO,gJAAO,QAAQ,CAAC,6BAA6B,IAAI,CAAC,gJAAO,YAAY,CAAC,sBAAsB,qBAAqB,gJAAO,YAAY,CAAC,aAAa;QACzJ,MAAM,gBAAgB,OAAO,gJAAO,OAAO,CAAC,oBAAoB,CAAC,OAAO,gJAAO,GAAG,CAAC;gBAC3E,MAAM,MAAM,OAAO,CAAA,GAAA,wJAAA,CAAA,cAAW,AAAD,EAAE,MAAM,OAAO,aAAa,gBAAgB;gBACzE,MAAM,MAAM,OAAO,CAAA,GAAA,wJAAA,CAAA,oBAAiB,AAAD,EAAE,GAAG,UAAU,CAAC,EAAE,KAAK,EAAE,QAAQ;oBAChE,cAAc,aAAa,eAAe;oBAC1C,MAAM;wBACF,mBAAmB;wBACnB,kBAAkB,KAAK,IAAI;wBAC3B,kBAAkB,KAAK,IAAI;wBAC3B,kBAAkB,KAAK,IAAI;wBAC3B,aAAa;wBACb,kBAAkB,KAAK,QAAQ;wBAC/B,4BAA4B,KAAK,kBAAkB;wBACnD,YAAY,KAAK,GAAG;oBACxB;gBACJ;gBACA,OAAO;oBACH;oBACA;gBACJ;YACJ,IAAI;YACJ,aAAa;QACjB;QACA,MAAM,YAAY,OAAO,qNAAA,CAAA,oBAAiB,CAAC,iBAAiB;QAC5D,MAAM,aAAa,OAAO,qNAAA,CAAA,oBAAiB,CAAC,KAAK,CAAC;QAClD,MAAM,iBAAiB,OAAO,gJAAO,MAAM,CAAC,eAAe,IAAI,CAAC,gJAAO,WAAW,CAAC,WAAW,MAAM,GAAG,WAAW,QAAQ,GAAG,gJAAO,GAAG,CAAC,CAAC,MAAM,qNAAA,CAAA,oBAAiB,CAAC,IAAI,CAAC,KAAK,IAAI,CAAC,qNAAA,CAAA,oBAAiB,CAAC,cAAc,CAAC,QAAQ;QACzN,MAAM,kBAAkB,qNAAA,CAAA,oBAAiB,CAAC,IAAI,CAAC,mBAAmB,IAAI,CAAC,qNAAA,CAAA,oBAAiB,CAAC,UAAU,CAAC,YAAY,qNAAA,CAAA,oBAAiB,CAAC,UAAU,CAAC;YACzI,yBAAyB,kJAAS,KAAK,CAAC;YACxC,yBAAyB;YACzB,4BAA4B;YAC5B,4BAA4B;QAChC,IAAI,qNAAA,CAAA,oBAAiB,CAAC,QAAQ,CAAC;YAC3B,UAAU,cAAc,GAAG,CAAC,CAAC,EAAE,GAAG,EAAE,GAAG;YACvC,UAAU;YACV;YACA,aAAa,eAAe,GAAG;YAC/B,cAAc;YACd,iBAAiB,aAAa,eAAe,IAAI;QACrD,IAAI,gJAAO,OAAO,CAAC,WAAW,OAAO;QACrC,wDAAwD;QACxD,qEAAqE;QACrE,2BAA2B;QAC3B,MAAM,QAAQ,OAAO,gJAAO,EAAE,CAAC,OAAO;YAClC,QAAQ,IAAI,gBAAgB,IAAI,CAAC,gJAAO,OAAO,CAAC;oBACxC,WAAW,sBAAsB,uBAAuB;wBACpD,OAAO;oBACX;oBACA,WAAW,mBAAmB;gBAClC,IAAI,uNAAA,CAAA,qBAAkB,CAAC,MAAM,EAAE,qBAAqB,yBAAyB,CAAC,QAAQ,eAAe,IAAI,CAAC,qNAAA,CAAA,oBAAiB,CAAC,UAAU,CAAC;wBAC/H,oBAAoB,MAAM,IAAI;wBAC9B,2BAA2B,MAAM,SAAS;oBAC9C,IAAI,qNAAA,CAAA,oBAAiB,CAAC,OAAO,CAAC,mMAAA,CAAA,WAAQ,CAAC,IAAI,CAAC,MAAM,OAAO,EAAE,sBAAsB,WAAW,OAAO,EAAE,gJAAO,OAAO,CAAC;wBAChH,WAAW,sBAAsB;wBACjC,WAAW,mBAAmB;oBAClC,IAAI,gJAAO,YAAY,CAAC,QAAQ,gJAAO,MAAM,EAAE,gJAAO,YAAY,EAAE,gJAAO,MAAM;YACzF,SAAS,IAAI,gBAAgB,IAAI,CAAC,gJAAO,OAAO,CAAC;oBACzC,WAAW,sBAAsB;oBACjC,WAAW,mBAAmB;gBAClC,IAAI,gJAAO,OAAO,CAAC,uNAAA,CAAA,qBAAkB,CAAC,cAAc,CAAC,yBAAyB,gJAAO,MAAM;QACnG,GAAG,IAAI,CAAC,gJAAO,UAAU;QACzB,MAAM,aAAa,cAAc,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC;gBACtC,KAAK,EAAE,GAAG;gBACV,KAAK,EAAE,GAAG;gBACV,MAAM,kBAAkB,CAAC,EAAE,CAAC,IAAI;gBAChC,UAAU,kBAAkB,CAAC,EAAE,CAAC,QAAQ,IAAI;YAChD,CAAC;QACL,OAAO,gJAAO,OAAO,CAAC,oCAAoC,IAAI,CAAC,gJAAO,YAAY,CAAC,iBAAiB;QACpG,OAAO;YACH,MAAM;YACN;QACJ;IACJ,GAAG,IAAI,CAAC,gJAAO,WAAW,CAAC;AAE/B,SAAS,sBAAsB,UAAU,CAAC,CAAC;IACvC,MAAM,OAAO;QACT,QAAQ,CAAC;QACT,wBAAwB;QACxB,cAAc;YACV,OAAO;gBACH,aAAa;YACjB;QACJ;QACA,cAAc;YACV,iBAAiB;QACrB;QACA,aAAa;YACT,YAAY,IAAI,QAAQ,OAAO,CAAC;YAChC,QAAQ;YACR,SAAS;QACb;QACA,YAAY,IAAI,CAAC,CAAC,CAAC;QACnB,eAAe;QACf,OAAO;QACP;QACA,kBAAkB,IAAI;QACtB,gBAAgB,QAAQ,cAAc,IAAI;QAC1C,qCAAqC;QACrC,GAAG,OAAO;IACd;IACA,OAAO;QACH,OAAO,UAAU;YACb,OAAO,sBAAsB;gBACzB,GAAG,IAAI;gBACP,aAAa;YACjB;QACJ;QACA,YAAY,cAAc;YACtB,OAAO,sBAAsB;gBACzB,GAAG,IAAI;gBACP,YAAY;YAChB;QACJ;QACA,kBAAkB,kBAAkB;YAChC,OAAO;gBACH,GAAG,IAAI;gBACP,kBAAkB;YACtB;QACJ;QACA,eAAe,iBAAiB;YAC5B,OAAO,sBAAsB;gBACzB,GAAG,IAAI;gBACP,eAAe;YACnB;QACJ;IACJ;AACJ;AACA,SAAS,cAAc,IAAI;IACvB,OAAO,CAAC,OAAO;QACX,OAAO,sBAAsB;YACzB,cAAc;YACd,cAAc,UAAU,CAAC;YACzB,GAAG,IAAI;QACX;IACJ;AACJ;AAEA,MAAM,oBAAoB,CAAC,OAAO,cAAc;AAChD,MAAM,qBAAqB,CAAC;IACxB,MAAM,UAAU,mBAAmB,CAAC,MAAM,gJAAO,OAAO,CAAC;YACjD;YACA,KAAK;YACL,OAAO;QACX,IAAI,CAAC,MAAM,gJAAO,OAAO,CAAC,MAAM,MAAM;IAC1C,OAAO;QACH,MAAM;QACN,KAAK;IACT;AACJ","ignoreList":[0]}},
    {"offset": {"line": 819, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 825, "column": 0}, "map": {"version":3,"sources":["file:///home/yurtur/projects/candle-constructor/node_modules/uploadthing/server/index.js"],"sourcesContent":["import * as Effect from 'effect/Effect';\nimport { ValidContentDispositions, ValidACLs, filterDefinedObjectValues, UploadThingError, objectKeys, fillInputRouteConfig, matchFileType, InvalidRouteConfigError, fileSizeToBytes, bytesToFileSize, getStatusCodeFromError, verifySignature, generateKey, generateSignedURL, parseTimeToSeconds } from '@uploadthing/shared';\nexport { UploadThingError } from '@uploadthing/shared';\nimport { FetchHttpClient, Headers, HttpApp, HttpServerResponse, HttpServerRequest, HttpRouter, HttpClient, HttpClientRequest, HttpClientResponse, HttpBody } from '@effect/platform';\nimport * as Config from 'effect/Config';\nimport * as Context from 'effect/Context';\nimport * as Match from 'effect/Match';\nimport * as Redacted from 'effect/Redacted';\nimport * as S from 'effect/Schema';\nimport * as ConfigProvider from 'effect/ConfigProvider';\nimport * as Stream from 'effect/Stream';\nimport * as Layer from 'effect/Layer';\nimport * as Logger from 'effect/Logger';\nimport * as LogLevel from 'effect/LogLevel';\nimport * as Cause from 'effect/Cause';\nimport * as Data from 'effect/Data';\nimport * as Runtime from 'effect/Runtime';\nimport * as FiberRef from 'effect/FiberRef';\nimport * as ManagedRuntime from 'effect/ManagedRuntime';\nimport { UTFiles } from '../internal/types.js';\nexport { UTFiles } from '../internal/types.js';\nimport * as Arr from 'effect/Array';\nimport { lookup } from '@uploadthing/mime-types';\nimport * as Predicate from 'effect/Predicate';\nimport { unsafeCoerce } from 'effect/Function';\n\nvar version = \"7.4.1\";\n\nS.Literal(...ValidContentDispositions);\nS.Literal(...ValidACLs);\n/**\n * Valid options for the `?actionType` query param\n */ const ActionType = S.Literal(\"upload\");\n/**\n * Valid options for the `uploadthing-hook` header\n * for requests coming from UT server\n */ const UploadThingHook = S.Literal(\"callback\", \"error\");\n/**\n * =============================================================================\n * =========================== Configuration ===================================\n * =============================================================================\n */ const DecodeString = S.transform(S.Uint8ArrayFromSelf, S.String, {\n    decode: (data)=>new TextDecoder().decode(data),\n    encode: (data)=>new TextEncoder().encode(data)\n});\nconst ParsedToken = S.Struct({\n    apiKey: S.Redacted(S.String.pipe(S.startsWith(\"sk_\"))),\n    appId: S.String,\n    regions: S.NonEmptyArray(S.String),\n    ingestHost: S.String.pipe(S.optionalWith({\n        default: ()=>\"ingest.uploadthing.com\"\n    }))\n});\nconst UploadThingToken = S.Uint8ArrayFromBase64.pipe(S.compose(DecodeString), S.compose(S.parseJson(ParsedToken)));\n/**\n * =============================================================================\n * ======================== File Type Hierarchy ===============================\n * =============================================================================\n */ /**\n * Properties from the web File object, this is what the client sends when initiating an upload\n */ class FileUploadData extends S.Class(\"FileUploadData\")({\n    name: S.String,\n    size: S.Number,\n    type: S.String,\n    lastModified: S.Number.pipe(S.optional)\n}) {\n}\n/**\n * `.middleware()` can add a customId to the incoming file data\n */ class FileUploadDataWithCustomId extends FileUploadData.extend(\"FileUploadDataWithCustomId\")({\n    customId: S.NullOr(S.String)\n}) {\n}\n/**\n * When files are uploaded, we get back\n * - a key\n * - a direct URL for the file\n * - an app-specific URL for the file (useful for scoping eg. for optimization allowed origins)\n * - the hash (md5-hex) of the uploaded file's contents\n */ class UploadedFileData extends FileUploadDataWithCustomId.extend(\"UploadedFileData\")({\n    key: S.String,\n    url: S.String,\n    appUrl: S.String,\n    fileHash: S.String\n}) {\n}\n/**\n * =============================================================================\n * ======================== Server Response Schemas ============================\n * =============================================================================\n */ class NewPresignedUrl extends S.Class(\"NewPresignedUrl\")({\n    url: S.String,\n    key: S.String,\n    customId: S.NullOr(S.String),\n    name: S.String\n}) {\n}\nclass MetadataFetchStreamPart extends S.Class(\"MetadataFetchStreamPart\")({\n    payload: S.String,\n    signature: S.String,\n    hook: UploadThingHook\n}) {\n}\nclass MetadataFetchResponse extends S.Class(\"MetadataFetchResponse\")({\n    ok: S.Boolean\n}) {\n}\nclass CallbackResultResponse extends S.Class(\"CallbackResultResponse\")({\n    ok: S.Boolean\n}) {\n}\n/**\n * =============================================================================\n * ======================== Client Action Payloads ============================\n * =============================================================================\n */ class UploadActionPayload extends S.Class(\"UploadActionPayload\")({\n    files: S.Array(FileUploadData),\n    input: S.Unknown\n}) {\n}\n\n/**\n * Merge in `import.meta.env` to the built-in `process.env` provider\n * Prefix keys with `UPLOADTHING_` so we can reference just the name.\n * @example\n * process.env.UPLOADTHING_TOKEN = \"foo\"\n * Config.string(\"token\"); // Config<\"foo\">\n */ const envProvider = ConfigProvider.fromEnv().pipe(ConfigProvider.orElse(()=>ConfigProvider.fromMap(new Map(Object.entries(filterDefinedObjectValues(// fuck this I give up. import.meta is a mistake, someone else can fix it\n    import.meta?.env ?? {}))), {\n        pathDelim: \"_\"\n    })), ConfigProvider.nested(\"uploadthing\"), ConfigProvider.constantCase);\n/**\n * Config provider that merges the options from the object\n * and environment variables prefixed with `UPLOADTHING_`.\n * @remarks Options take precedence over environment variables.\n */ const configProvider = (options)=>ConfigProvider.fromJson(options ?? {}).pipe(ConfigProvider.orElse(()=>envProvider));\nconst IsDevelopment = Config.boolean(\"isDev\").pipe(Config.orElse(()=>Config.succeed(typeof process !== \"undefined\" ? \"production\" : undefined).pipe(Config.map((_)=>_ === \"development\"))), Config.withDefault(false));\nconst UTToken = S.Config(\"token\", UploadThingToken).pipe(Effect.catchTags({\n    ConfigError: (e)=>new UploadThingError({\n            code: e._op === \"InvalidData\" ? \"INVALID_SERVER_CONFIG\" : \"MISSING_ENV\",\n            message: e._op === \"InvalidData\" ? \"Invalid token. A token is a base64 encoded JSON object matching { apiKey: string, appId: string, regions: string[] }.\" : \"Missing token. Please set the `UPLOADTHING_TOKEN` environment variable or provide a token manually through config.\",\n            cause: e\n        })\n}));\nconst ApiUrl = Config.string(\"apiUrl\").pipe(Config.withDefault(\"https://api.uploadthing.com\"), Config.mapAttempt((_)=>new URL(_)), Config.map((url)=>url.href.replace(/\\/$/, \"\")));\nconst IngestUrl = Effect.gen(function*() {\n    const { regions, ingestHost } = yield* UTToken;\n    const region = regions[0]; // Currently only support 1 region per app\n    return yield* Config.string(\"ingestUrl\").pipe(Config.withDefault(`https://${region}.${ingestHost}`), Config.mapAttempt((_)=>new URL(_)), Config.map((url)=>url.href.replace(/\\/$/, \"\")));\n});\n\nfunction defaultErrorFormatter(error) {\n    return {\n        message: error.message\n    };\n}\nfunction formatError(error, router) {\n    const errorFormatter = router[Object.keys(router)[0]]?.errorFormatter ?? defaultErrorFormatter;\n    return errorFormatter(error);\n}\n\nconst handleJsonLineStream = (schema, onChunk)=>(stream)=>{\n        let buf = \"\";\n        return stream.pipe(Stream.decodeText(), Stream.mapEffect((chunk)=>Effect.gen(function*() {\n                buf += chunk;\n                // Scan buffer for newlines\n                const parts = buf.split(\"\\n\");\n                const validChunks = [];\n                for (const part of parts){\n                    try {\n                        // Attempt to parse chunk as JSON\n                        validChunks.push(JSON.parse(part));\n                        // Advance buffer if parsing succeeded\n                        buf = buf.slice(part.length + 1);\n                    } catch  {\n                    //\n                    }\n                }\n                yield* Effect.logDebug(\"Received chunks\").pipe(Effect.annotateLogs(\"chunk\", chunk), Effect.annotateLogs(\"parsedChunks\", validChunks), Effect.annotateLogs(\"buf\", buf));\n                return validChunks;\n            })), Stream.mapEffect(S.decodeUnknown(S.Array(schema))), Stream.mapEffect(Effect.forEach((part)=>onChunk(part))), Stream.runDrain, Effect.withLogSpan(\"handleJsonLineStream\"));\n    };\n\nconst withMinimalLogLevel = Config.logLevel(\"logLevel\").pipe(Config.withDefault(LogLevel.Info), Effect.andThen((level)=>Logger.minimumLogLevel(level)), Effect.tapError((e)=>Effect.logError(\"Invalid log level\").pipe(Effect.annotateLogs(\"error\", e))), Effect.catchTag(\"ConfigError\", (e)=>new UploadThingError({\n        code: \"INVALID_SERVER_CONFIG\",\n        message: \"Invalid server configuration\",\n        cause: e\n    })), Layer.unwrapEffect);\nconst LogFormat = Config.literal(\"json\", \"logFmt\", \"structured\", \"pretty\")(\"logFormat\");\nconst withLogFormat = Effect.gen(function*() {\n    const isDev = yield* IsDevelopment;\n    const logFormat = yield* LogFormat.pipe(Config.withDefault(isDev ? \"pretty\" : \"json\"));\n    return Logger[logFormat];\n}).pipe(Effect.catchTag(\"ConfigError\", (e)=>new UploadThingError({\n        code: \"INVALID_SERVER_CONFIG\",\n        message: \"Invalid server configuration\",\n        cause: e\n    })), Layer.unwrapEffect);\nconst logHttpClientResponse = (message, opts)=>{\n    const mixin = opts?.mixin ?? \"json\";\n    const level = LogLevel.fromLiteral(opts?.level ?? \"Debug\");\n    return (response)=>Effect.flatMap(mixin !== \"None\" ? response[mixin] : Effect.void, ()=>Effect.logWithLevel(level, `${message} (${response.status})`).pipe(Effect.annotateLogs(\"response\", response)));\n};\nconst logHttpClientError = (message)=>(err)=>err._tag === \"ResponseError\" ? logHttpClientResponse(message, {\n            level: \"Error\"\n        })(err.response) : Effect.logError(message).pipe(Effect.annotateLogs(\"error\", err));\n\nclass ParserError extends Data.TaggedError(\"ParserError\") {\n    constructor(...args){\n        super(...args), this.message = \"Input validation failed. The original error with it's validation issues is in the error cause.\";\n    }\n}\nfunction getParseFn(parser) {\n    if (\"~standard\" in parser) {\n        /**\n     * Standard Schema\n     */ return async (value)=>{\n            const result = await parser[\"~standard\"].validate(value);\n            if (result.issues) {\n                throw new ParserError({\n                    cause: result.issues\n                });\n            }\n            return result.value;\n        };\n    }\n    if (\"parseAsync\" in parser && typeof parser.parseAsync === \"function\") {\n        /**\n     * Zod\n     * TODO (next major): Consider wrapping ZodError in ParserError\n     */ return parser.parseAsync;\n    }\n    if (S.isSchema(parser)) {\n        /**\n     * Effect Schema\n     */ return (value)=>S.decodeUnknownPromise(parser)(value).catch((error)=>{\n                throw new ParserError({\n                    cause: Cause.squash(error[Runtime.FiberFailureCauseId])\n                });\n            });\n    }\n    throw new Error(\"Invalid parser\");\n}\n\nclass FileSizeMismatch extends Data.Error {\n    constructor(type, max, actual){\n        const reason = `You uploaded a ${type} file that was ${bytesToFileSize(actual)}, but the limit for that type is ${max}`;\n        super({\n            reason\n        }), this._tag = \"FileSizeMismatch\", this.name = \"FileSizeMismatchError\";\n    }\n}\nclass FileCountMismatch extends Data.Error {\n    constructor(type, boundtype, bound, actual){\n        const reason = `You uploaded ${actual} file(s) of type '${type}', but the ${boundtype} for that type is ${bound}`;\n        super({\n            reason\n        }), this._tag = \"FileCountMismatch\", this.name = \"FileCountMismatchError\";\n    }\n}\n// Verify that the uploaded files doesn't violate the route config,\n// e.g. uploading more videos than allowed, or a file that is larger than allowed.\n// This is double-checked on infra side, but we want to fail early to avoid network latency.\nconst assertFilesMeetConfig = (files, routeConfig)=>Effect.gen(function*() {\n        const counts = {};\n        for (const file of files){\n            const type = yield* matchFileType(file, objectKeys(routeConfig));\n            counts[type] = (counts[type] ?? 0) + 1;\n            const sizeLimit = routeConfig[type]?.maxFileSize;\n            if (!sizeLimit) {\n                return yield* new InvalidRouteConfigError(type, \"maxFileSize\");\n            }\n            const sizeLimitBytes = yield* fileSizeToBytes(sizeLimit);\n            if (file.size > sizeLimitBytes) {\n                return yield* new FileSizeMismatch(type, sizeLimit, file.size);\n            }\n        }\n        for(const _key in counts){\n            const key = _key;\n            const config = routeConfig[key];\n            if (!config) return yield* new InvalidRouteConfigError(key);\n            const count = counts[key];\n            const min = config.minFileCount;\n            const max = config.maxFileCount;\n            if (min > max) {\n                return yield* new UploadThingError({\n                    code: \"BAD_REQUEST\",\n                    message: \"Invalid config during file count - minFileCount > maxFileCount\",\n                    cause: `minFileCount must be less than maxFileCount for key ${key}. got: ${min} > ${max}`\n                });\n            }\n            if (count < min) {\n                return yield* new FileCountMismatch(key, \"minimum\", min, count);\n            }\n            if (count > max) {\n                return yield* new FileCountMismatch(key, \"maximum\", max, count);\n            }\n        }\n        return null;\n    });\nconst extractRouterConfig$1 = (router)=>Effect.forEach(objectKeys(router), (slug)=>Effect.map(fillInputRouteConfig(router[slug].routerConfig), (config)=>({\n                slug,\n                config\n            })));\n\nconst makeRuntime = (fetch, config)=>{\n    const fetchHttpClient = Layer.provideMerge(FetchHttpClient.layer, Layer.succeed(FetchHttpClient.Fetch, fetch));\n    const withRedactedHeaders = Layer.effectDiscard(FiberRef.update(Headers.currentRedactedNames, (_)=>_.concat([\n            \"x-uploadthing-api-key\"\n        ])));\n    const layer = Layer.provide(Layer.mergeAll(withLogFormat, withMinimalLogLevel, fetchHttpClient, withRedactedHeaders), Layer.setConfigProvider(configProvider(config)));\n    return ManagedRuntime.make(layer);\n};\n\nclass AdapterArguments extends Context.Tag(\"uploadthing/AdapterArguments\")() {\n}\nconst makeAdapterHandler = (makeAdapterArgs, toRequest, opts, beAdapter)=>{\n    const managed = makeRuntime(opts.config?.fetch, opts.config);\n    const handle = Effect.promise(()=>managed.runtime().then(HttpApp.toWebHandlerRuntime));\n    const app = (...args)=>Effect.map(Effect.promise(()=>managed.runPromise(createRequestHandler(opts, beAdapter))), Effect.provideServiceEffect(AdapterArguments, makeAdapterArgs(...args)));\n    return async (...args)=>{\n        const result = await handle.pipe(Effect.ap(app(...args)), Effect.ap(toRequest(...args)), Effect.withLogSpan(\"requestHandler\"), managed.runPromise);\n        return result;\n    };\n};\nconst createRequestHandler = (opts, beAdapter)=>Effect.gen(function*() {\n        const isDevelopment = yield* IsDevelopment;\n        const routerConfig = yield* extractRouterConfig$1(opts.router);\n        const handleDaemon = (()=>{\n            if (opts.config?.handleDaemonPromise) {\n                return opts.config.handleDaemonPromise;\n            }\n            return isDevelopment ? \"void\" : \"await\";\n        })();\n        if (isDevelopment && handleDaemon === \"await\") {\n            return yield* new UploadThingError({\n                code: \"INVALID_SERVER_CONFIG\",\n                message: 'handleDaemonPromise: \"await\" is forbidden in development.'\n            });\n        }\n        const GET = Effect.gen(function*() {\n            return yield* HttpServerResponse.json(routerConfig);\n        });\n        const POST = Effect.gen(function*() {\n            const { \"uploadthing-hook\": uploadthingHook, \"x-uploadthing-package\": fePackage, \"x-uploadthing-version\": clientVersion } = yield* HttpServerRequest.schemaHeaders(S.Struct({\n                \"uploadthing-hook\": UploadThingHook.pipe(S.optional),\n                \"x-uploadthing-package\": S.String.pipe(S.optionalWith({\n                    default: ()=>\"unknown\"\n                })),\n                \"x-uploadthing-version\": S.String.pipe(S.optionalWith({\n                    default: ()=>version\n                }))\n            }));\n            if (clientVersion !== version) {\n                const serverVersion = version;\n                yield* Effect.logWarning(\"Client version mismatch. Things may not work as expected, please sync your versions to ensure compatibility.\").pipe(Effect.annotateLogs({\n                    clientVersion,\n                    serverVersion\n                }));\n            }\n            const { slug, actionType } = yield* HttpRouter.schemaParams(S.Struct({\n                actionType: ActionType.pipe(S.optional),\n                slug: S.String\n            }));\n            const uploadable = opts.router[slug];\n            if (!uploadable) {\n                const msg = `No file route found for slug ${slug}`;\n                yield* Effect.logError(msg);\n                return yield* new UploadThingError({\n                    code: \"NOT_FOUND\",\n                    message: msg\n                });\n            }\n            const { body, fiber } = yield* Match.value({\n                actionType,\n                uploadthingHook\n            }).pipe(Match.when({\n                actionType: \"upload\",\n                uploadthingHook: undefined\n            }, ()=>handleUploadAction({\n                    uploadable,\n                    fePackage,\n                    beAdapter,\n                    slug\n                })), Match.when({\n                actionType: undefined,\n                uploadthingHook: \"callback\"\n            }, ()=>handleCallbackRequest({\n                    uploadable,\n                    fePackage,\n                    beAdapter\n                })), Match.when({\n                actionType: undefined,\n                uploadthingHook: \"error\"\n            }, ()=>handleErrorRequest({\n                    uploadable\n                })), Match.orElse(()=>Effect.succeed({\n                    body: null,\n                    fiber: null\n                })));\n            if (fiber) {\n                yield* Effect.logDebug(\"Running fiber as daemon\").pipe(Effect.annotateLogs(\"handleDaemon\", handleDaemon));\n                if (handleDaemon === \"void\") ; else if (handleDaemon === \"await\") {\n                    yield* fiber.await;\n                } else if (typeof handleDaemon === \"function\") {\n                    handleDaemon(Effect.runPromise(fiber.await));\n                }\n            }\n            yield* Effect.logDebug(\"Sending response\").pipe(Effect.annotateLogs(\"body\", body));\n            return yield* HttpServerResponse.json(body);\n        }).pipe(Effect.catchTags({\n            ParseError: (e)=>HttpServerResponse.json(formatError(new UploadThingError({\n                    code: \"BAD_REQUEST\",\n                    message: \"Invalid input\",\n                    cause: e.message\n                }), opts.router), {\n                    status: 400\n                }),\n            UploadThingError: (e)=>// eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n                HttpServerResponse.json(formatError(e, opts.router), {\n                    status: getStatusCodeFromError(e)\n                })\n        }));\n        const appendResponseHeaders = Effect.map(HttpServerResponse.setHeader(\"x-uploadthing-version\", version));\n        return HttpRouter.empty.pipe(HttpRouter.get(\"*\", GET), HttpRouter.post(\"*\", POST), HttpRouter.use(appendResponseHeaders));\n    }).pipe(Effect.withLogSpan(\"createRequestHandler\"));\nconst handleErrorRequest = (opts)=>Effect.gen(function*() {\n        const { uploadable } = opts;\n        const request = yield* HttpServerRequest.HttpServerRequest;\n        const { apiKey } = yield* UTToken;\n        const verified = yield* verifySignature((yield* request.text), request.headers[\"x-uploadthing-signature\"], apiKey);\n        yield* Effect.logDebug(`Signature verified: ${verified}`);\n        if (!verified) {\n            yield* Effect.logError(\"Invalid signature\");\n            return yield* new UploadThingError({\n                code: \"BAD_REQUEST\",\n                message: \"Invalid signature\"\n            });\n        }\n        const requestInput = yield* HttpServerRequest.schemaBodyJson(S.Struct({\n            fileKey: S.String,\n            error: S.String\n        }));\n        yield* Effect.logDebug(\"Handling error callback request with input:\").pipe(Effect.annotateLogs(\"json\", requestInput));\n        const adapterArgs = yield* AdapterArguments;\n        const fiber = yield* Effect.tryPromise({\n            try: async ()=>uploadable.onUploadError({\n                    ...adapterArgs,\n                    error: new UploadThingError({\n                        code: \"UPLOAD_FAILED\",\n                        message: `Upload failed for ${requestInput.fileKey}: ${requestInput.error}`\n                    }),\n                    fileKey: requestInput.fileKey\n                }),\n            catch: (error)=>new UploadThingError({\n                    code: \"INTERNAL_SERVER_ERROR\",\n                    message: \"Failed to run onUploadError\",\n                    cause: error\n                })\n        }).pipe(Effect.tapError((error)=>Effect.logError(\"Failed to run onUploadError. You probably shouldn't be throwing errors here.\").pipe(Effect.annotateLogs(\"error\", error)))).pipe(Effect.ignoreLogged, Effect.forkDaemon);\n        return {\n            body: null,\n            fiber\n        };\n    }).pipe(Effect.withLogSpan(\"handleErrorRequest\"));\nconst handleCallbackRequest = (opts)=>Effect.gen(function*() {\n        const { uploadable, fePackage, beAdapter } = opts;\n        const request = yield* HttpServerRequest.HttpServerRequest;\n        const { apiKey } = yield* UTToken;\n        const verified = yield* verifySignature((yield* request.text), request.headers[\"x-uploadthing-signature\"], apiKey);\n        yield* Effect.logDebug(`Signature verified: ${verified}`);\n        if (!verified) {\n            yield* Effect.logError(\"Invalid signature\");\n            return yield* new UploadThingError({\n                code: \"BAD_REQUEST\",\n                message: \"Invalid signature\"\n            });\n        }\n        const requestInput = yield* HttpServerRequest.schemaBodyJson(S.Struct({\n            status: S.String,\n            file: UploadedFileData,\n            metadata: S.Record({\n                key: S.String,\n                value: S.Unknown\n            })\n        }));\n        yield* Effect.logDebug(\"Handling callback request with input:\").pipe(Effect.annotateLogs(\"json\", requestInput));\n        /**\n     * Run `.onUploadComplete` as a daemon to prevent the\n     * request from UT to potentially timeout.\n     */ const fiber = yield* Effect.gen(function*() {\n            const adapterArgs = yield* AdapterArguments;\n            const serverData = yield* Effect.tryPromise({\n                try: async ()=>uploadable.onUploadComplete({\n                        ...adapterArgs,\n                        file: requestInput.file,\n                        metadata: requestInput.metadata\n                    }),\n                catch: (error)=>new UploadThingError({\n                        code: \"INTERNAL_SERVER_ERROR\",\n                        message: \"Failed to run onUploadComplete. You probably shouldn't be throwing errors here.\",\n                        cause: error\n                    })\n            });\n            const payload = {\n                fileKey: requestInput.file.key,\n                callbackData: serverData ?? null\n            };\n            yield* Effect.logDebug(\"'onUploadComplete' callback finished. Sending response to UploadThing:\").pipe(Effect.annotateLogs(\"callbackData\", payload));\n            const baseUrl = yield* IngestUrl;\n            const httpClient = (yield* HttpClient.HttpClient).pipe(HttpClient.filterStatusOk);\n            yield* HttpClientRequest.post(`/callback-result`).pipe(HttpClientRequest.prependUrl(baseUrl), HttpClientRequest.setHeaders({\n                \"x-uploadthing-api-key\": Redacted.value(apiKey),\n                \"x-uploadthing-version\": version,\n                \"x-uploadthing-be-adapter\": beAdapter,\n                \"x-uploadthing-fe-package\": fePackage\n            }), HttpClientRequest.bodyJson(payload), Effect.flatMap(httpClient.execute), Effect.tapError(logHttpClientError(\"Failed to register callback result\")), Effect.flatMap(HttpClientResponse.schemaBodyJson(CallbackResultResponse)), Effect.tap(Effect.log(\"Sent callback result to UploadThing\")), Effect.scoped);\n        }).pipe(Effect.ignoreLogged, Effect.forkDaemon);\n        return {\n            body: null,\n            fiber\n        };\n    }).pipe(Effect.withLogSpan(\"handleCallbackRequest\"));\nconst runRouteMiddleware = (opts)=>Effect.gen(function*() {\n        const { json: { files, input }, uploadable } = opts;\n        yield* Effect.logDebug(\"Running middleware\");\n        const adapterArgs = yield* AdapterArguments;\n        const metadata = yield* Effect.tryPromise({\n            try: async ()=>uploadable.middleware({\n                    ...adapterArgs,\n                    input,\n                    files\n                }),\n            catch: (error)=>error instanceof UploadThingError ? error : new UploadThingError({\n                    code: \"INTERNAL_SERVER_ERROR\",\n                    message: \"Failed to run middleware\",\n                    cause: error\n                })\n        });\n        if (metadata[UTFiles] && metadata[UTFiles].length !== files.length) {\n            const msg = `Expected files override to have the same length as original files, got ${metadata[UTFiles].length} but expected ${files.length}`;\n            yield* Effect.logError(msg);\n            return yield* new UploadThingError({\n                code: \"BAD_REQUEST\",\n                message: \"Files override must have the same length as files\",\n                cause: msg\n            });\n        }\n        // Attach customIds from middleware to the files\n        const filesWithCustomIds = yield* Effect.forEach(files, (file, idx)=>Effect.gen(function*() {\n                const theirs = metadata[UTFiles]?.[idx];\n                if (theirs && theirs.size !== file.size) {\n                    yield* Effect.logWarning(\"File size mismatch. Reverting to original size\");\n                }\n                return {\n                    name: theirs?.name ?? file.name,\n                    size: file.size,\n                    type: file.type,\n                    customId: theirs?.customId,\n                    lastModified: theirs?.lastModified ?? Date.now()\n                };\n            }));\n        return {\n            metadata,\n            filesWithCustomIds\n        };\n    }).pipe(Effect.withLogSpan(\"runRouteMiddleware\"));\nconst handleUploadAction = (opts)=>Effect.gen(function*() {\n        const httpClient = (yield* HttpClient.HttpClient).pipe(HttpClient.filterStatusOk);\n        const { uploadable, fePackage, beAdapter, slug } = opts;\n        const json = yield* HttpServerRequest.schemaBodyJson(UploadActionPayload);\n        yield* Effect.logDebug(\"Handling upload request\").pipe(Effect.annotateLogs(\"json\", json));\n        // validate the input\n        yield* Effect.logDebug(\"Parsing user input\");\n        const parsedInput = yield* Effect.tryPromise({\n            try: ()=>getParseFn(uploadable.inputParser)(json.input),\n            catch: (error)=>new UploadThingError({\n                    code: \"BAD_REQUEST\",\n                    message: \"Invalid input\",\n                    cause: error\n                })\n        });\n        yield* Effect.logDebug(\"Input parsed successfully\").pipe(Effect.annotateLogs(\"input\", parsedInput));\n        const { metadata, filesWithCustomIds } = yield* runRouteMiddleware({\n            json: {\n                input: parsedInput,\n                files: json.files\n            },\n            uploadable\n        });\n        yield* Effect.logDebug(\"Parsing route config\").pipe(Effect.annotateLogs(\"routerConfig\", uploadable.routerConfig));\n        const parsedConfig = yield* fillInputRouteConfig(uploadable.routerConfig).pipe(Effect.catchTag(\"InvalidRouteConfig\", (err)=>new UploadThingError({\n                code: \"BAD_REQUEST\",\n                message: \"Invalid route config\",\n                cause: err\n            })));\n        yield* Effect.logDebug(\"Route config parsed successfully\").pipe(Effect.annotateLogs(\"routeConfig\", parsedConfig));\n        yield* Effect.logDebug(\"Validating files meet the config requirements\").pipe(Effect.annotateLogs(\"files\", json.files));\n        yield* assertFilesMeetConfig(json.files, parsedConfig).pipe(Effect.mapError((e)=>new UploadThingError({\n                code: \"BAD_REQUEST\",\n                message: `Invalid config: ${e._tag}`,\n                cause: \"reason\" in e ? e.reason : e.message\n            })));\n        yield* Effect.logDebug(\"Files validated.\");\n        const fileUploadRequests = yield* Effect.forEach(filesWithCustomIds, (file)=>Effect.map(matchFileType(file, objectKeys(parsedConfig)), (type)=>({\n                    name: file.name,\n                    size: file.size,\n                    type: file.type || type,\n                    lastModified: file.lastModified,\n                    customId: file.customId,\n                    contentDisposition: parsedConfig[type]?.contentDisposition ?? \"inline\",\n                    acl: parsedConfig[type]?.acl\n                }))).pipe(Effect.catchTags({\n            /** Shouldn't happen since config is validated above so just dying is fine I think */ InvalidFileType: (e)=>Effect.die(e),\n            UnknownFileType: (e)=>Effect.die(e)\n        }));\n        const routeOptions = uploadable.routeOptions;\n        const { apiKey, appId } = yield* UTToken;\n        const ingestUrl = yield* IngestUrl;\n        const isDev = yield* IsDevelopment;\n        yield* Effect.logDebug(\"Generating presigned URLs\").pipe(Effect.annotateLogs(\"fileUploadRequests\", fileUploadRequests), Effect.annotateLogs(\"ingestUrl\", ingestUrl));\n        const presignedUrls = yield* Effect.forEach(fileUploadRequests, (file)=>Effect.gen(function*() {\n                const key = yield* generateKey(file, appId, routeOptions.getFileHashParts);\n                const url = yield* generateSignedURL(`${ingestUrl}/${key}`, apiKey, {\n                    ttlInSeconds: routeOptions.presignedURLTTL,\n                    data: {\n                        \"x-ut-identifier\": appId,\n                        \"x-ut-file-name\": file.name,\n                        \"x-ut-file-size\": file.size,\n                        \"x-ut-file-type\": file.type,\n                        \"x-ut-slug\": slug,\n                        \"x-ut-custom-id\": file.customId,\n                        \"x-ut-content-disposition\": file.contentDisposition,\n                        \"x-ut-acl\": file.acl\n                    }\n                });\n                return {\n                    url,\n                    key\n                };\n            }), {\n            concurrency: \"unbounded\"\n        });\n        const serverReq = yield* HttpServerRequest.HttpServerRequest;\n        const requestUrl = yield* HttpServerRequest.toURL(serverReq);\n        const devHookRequest = yield* Config.string(\"callbackUrl\").pipe(Config.withDefault(requestUrl.origin + requestUrl.pathname), Effect.map((url)=>HttpClientRequest.post(url).pipe(HttpClientRequest.appendUrlParam(\"slug\", slug))));\n        const metadataRequest = HttpClientRequest.post(\"/route-metadata\").pipe(HttpClientRequest.prependUrl(ingestUrl), HttpClientRequest.setHeaders({\n            \"x-uploadthing-api-key\": Redacted.value(apiKey),\n            \"x-uploadthing-version\": version,\n            \"x-uploadthing-be-adapter\": beAdapter,\n            \"x-uploadthing-fe-package\": fePackage\n        }), HttpClientRequest.bodyJson({\n            fileKeys: presignedUrls.map(({ key })=>key),\n            metadata: metadata,\n            isDev,\n            callbackUrl: devHookRequest.url,\n            callbackSlug: slug,\n            awaitServerData: routeOptions.awaitServerData ?? true\n        }), Effect.flatMap(httpClient.execute));\n        // Send metadata to UT server (non blocking as a daemon)\n        // In dev, keep the stream open and simulate the callback requests as\n        // files complete uploading\n        const fiber = yield* Effect.if(isDev, {\n            onTrue: ()=>metadataRequest.pipe(Effect.tapBoth({\n                    onSuccess: logHttpClientResponse(\"Registered metadata\", {\n                        mixin: \"None\"\n                    }),\n                    onFailure: logHttpClientError(\"Failed to register metadata\")\n                }), HttpClientResponse.stream, handleJsonLineStream(MetadataFetchStreamPart, (chunk)=>devHookRequest.pipe(HttpClientRequest.setHeaders({\n                        \"uploadthing-hook\": chunk.hook,\n                        \"x-uploadthing-signature\": chunk.signature\n                    }), HttpClientRequest.setBody(HttpBody.text(chunk.payload, \"application/json\")), httpClient.execute, Effect.tapBoth({\n                        onSuccess: logHttpClientResponse(\"Successfully forwarded callback request from dev stream\"),\n                        onFailure: logHttpClientError(\"Failed to forward callback request from dev stream\")\n                    }), Effect.annotateLogs(chunk), Effect.asVoid, Effect.ignoreLogged, Effect.scoped))),\n            onFalse: ()=>metadataRequest.pipe(Effect.tapBoth({\n                    onSuccess: logHttpClientResponse(\"Registered metadata\"),\n                    onFailure: logHttpClientError(\"Failed to register metadata\")\n                }), Effect.flatMap(HttpClientResponse.schemaBodyJson(MetadataFetchResponse)), Effect.scoped)\n        }).pipe(Effect.forkDaemon);\n        const presigneds = presignedUrls.map((p, i)=>({\n                url: p.url,\n                key: p.key,\n                name: fileUploadRequests[i].name,\n                customId: fileUploadRequests[i].customId ?? null\n            }));\n        yield* Effect.logInfo(\"Sending presigned URLs to client\").pipe(Effect.annotateLogs(\"presignedUrls\", presigneds));\n        return {\n            body: presigneds,\n            fiber\n        };\n    }).pipe(Effect.withLogSpan(\"handleUploadAction\"));\n\nfunction internalCreateBuilder(initDef = {}) {\n    const _def = {\n        $types: {},\n        // Default router config\n        routerConfig: {\n            image: {\n                maxFileSize: \"4MB\"\n            }\n        },\n        routeOptions: {\n            awaitServerData: true\n        },\n        inputParser: {\n            parseAsync: ()=>Promise.resolve(undefined),\n            _input: undefined,\n            _output: undefined\n        },\n        middleware: ()=>({}),\n        onUploadError: ()=>{\n        // noop\n        },\n        onUploadComplete: ()=>undefined,\n        errorFormatter: initDef.errorFormatter ?? defaultErrorFormatter,\n        // Overload with properties passed in\n        ...initDef\n    };\n    return {\n        input (userParser) {\n            return internalCreateBuilder({\n                ..._def,\n                inputParser: userParser\n            });\n        },\n        middleware (userMiddleware) {\n            return internalCreateBuilder({\n                ..._def,\n                middleware: userMiddleware\n            });\n        },\n        onUploadComplete (userUploadComplete) {\n            return {\n                ..._def,\n                onUploadComplete: userUploadComplete\n            };\n        },\n        onUploadError (userOnUploadError) {\n            return internalCreateBuilder({\n                ..._def,\n                onUploadError: userOnUploadError\n            });\n        }\n    };\n}\nfunction createBuilder(opts) {\n    return (input, config)=>{\n        return internalCreateBuilder({\n            routerConfig: input,\n            routeOptions: config ?? {},\n            ...opts\n        });\n    };\n}\n\n/**\n * Extension of the Blob class that simplifies setting the `name` and `customId` properties,\n * similar to the built-in File class from Node > 20.\n */ class UTFile extends Blob {\n    constructor(parts, name, options){\n        const optionsWithDefaults = {\n            ...options,\n            type: options?.type ?? (lookup(name) || \"application/octet-stream\"),\n            lastModified: options?.lastModified ?? Date.now()\n        };\n        super(parts, optionsWithDefaults);\n        this.name = name;\n        this.customId = optionsWithDefaults.customId;\n        this.lastModified = optionsWithDefaults.lastModified;\n    }\n}\n\nconst uploadWithoutProgress = (file, presigned)=>Effect.gen(function*() {\n        const formData = new FormData();\n        formData.append(\"file\", file); // File data **MUST GO LAST**\n        const httpClient = (yield* HttpClient.HttpClient).pipe(HttpClient.filterStatusOk);\n        const json = yield* HttpClientRequest.put(presigned.url).pipe(HttpClientRequest.bodyFormData(formData), HttpClientRequest.setHeader(\"Range\", \"bytes=0-\"), HttpClientRequest.setHeader(\"x-uploadthing-version\", version), httpClient.execute, Effect.mapError((e)=>new UploadThingError({\n                code: \"UPLOAD_FAILED\",\n                message: \"Failed to upload file\",\n                cause: e\n            })), Effect.andThen((_)=>_.json), Effect.andThen(unsafeCoerce), Effect.scoped);\n        yield* Effect.logDebug(`File ${file.name} uploaded successfully`).pipe(Effect.annotateLogs(\"json\", json));\n        return json;\n    });\n\nfunction guardServerOnly() {\n    if (typeof window !== \"undefined\") {\n        throw new UploadThingError({\n            code: \"INTERNAL_SERVER_ERROR\",\n            message: \"The `utapi` can only be used on the server.\"\n        });\n    }\n}\nconst downloadFile = (_url)=>Effect.gen(function*() {\n        let url = Predicate.isRecord(_url) ? _url.url : _url;\n        if (typeof url === \"string\") {\n            // since dataurls will result in name being too long, tell the user\n            // to use uploadFiles instead.\n            if (url.startsWith(\"data:\")) {\n                return yield* Effect.fail({\n                    code: \"BAD_REQUEST\",\n                    message: \"Please use uploadFiles() for data URLs. uploadFilesFromUrl() is intended for use with remote URLs only.\",\n                    data: undefined\n                });\n            }\n        }\n        url = new URL(url);\n        const { name = url.pathname.split(\"/\").pop() ?? \"unknown-filename\", customId = undefined } = Predicate.isRecord(_url) ? _url : {};\n        const httpClient = (yield* HttpClient.HttpClient).pipe(HttpClient.filterStatusOk);\n        const arrayBuffer = yield* HttpClientRequest.get(url).pipe(HttpClientRequest.modify({\n            headers: {}\n        }), httpClient.execute, Effect.flatMap((_)=>_.arrayBuffer), Effect.mapError((cause)=>{\n            return {\n                code: \"BAD_REQUEST\",\n                message: `Failed to download requested file: ${cause.message}`,\n                data: cause.toJSON()\n            };\n        }), Effect.scoped);\n        return new UTFile([\n            arrayBuffer\n        ], name, {\n            customId,\n            lastModified: Date.now()\n        });\n    }).pipe(Effect.withLogSpan(\"downloadFile\"));\nconst generatePresignedUrl = (file, cd, acl)=>Effect.gen(function*() {\n        const { apiKey, appId } = yield* UTToken;\n        const baseUrl = yield* IngestUrl;\n        const key = yield* generateKey(file, appId);\n        const url = yield* generateSignedURL(`${baseUrl}/${key}`, apiKey, {\n            // ttlInSeconds: routeOptions.presignedURLTTL,\n            data: {\n                \"x-ut-identifier\": appId,\n                \"x-ut-file-name\": file.name,\n                \"x-ut-file-size\": file.size,\n                \"x-ut-file-type\": file.type,\n                \"x-ut-custom-id\": file.customId,\n                \"x-ut-content-disposition\": cd,\n                \"x-ut-acl\": acl\n            }\n        });\n        return {\n            url,\n            key\n        };\n    }).pipe(Effect.withLogSpan(\"generatePresignedUrl\"));\nconst uploadFile = (file, opts)=>Effect.gen(function*() {\n        const presigned = yield* generatePresignedUrl(file, opts?.contentDisposition ?? \"inline\", opts?.acl).pipe(Effect.catchTag(\"ConfigError\", ()=>Effect.fail({\n                code: \"INVALID_SERVER_CONFIG\",\n                message: \"Failed to generate presigned URL\"\n            })));\n        const response = yield* uploadWithoutProgress(file, presigned).pipe(Effect.catchTag(\"ResponseError\", (e)=>Effect.fail({\n                code: \"UPLOAD_FAILED\",\n                message: \"Failed to upload file\",\n                data: e.toJSON()\n            })));\n        return {\n            key: presigned.key,\n            url: response.url,\n            appUrl: response.appUrl,\n            lastModified: file.lastModified ?? Date.now(),\n            name: file.name,\n            size: file.size,\n            type: file.type,\n            customId: file.customId ?? null,\n            fileHash: response.fileHash\n        };\n    }).pipe(Effect.withLogSpan(\"uploadFile\"));\n\nclass UTApi {\n    constructor(opts){\n        this.opts = opts;\n        this.requestUploadThing = (pathname, body, responseSchema)=>Effect.gen(this, function*() {\n                const { apiKey } = yield* UTToken;\n                const baseUrl = yield* ApiUrl;\n                const httpClient = (yield* HttpClient.HttpClient).pipe(HttpClient.filterStatusOk);\n                return yield* HttpClientRequest.post(pathname).pipe(HttpClientRequest.prependUrl(baseUrl), HttpClientRequest.bodyUnsafeJson(body), HttpClientRequest.setHeaders({\n                    \"x-uploadthing-version\": version,\n                    \"x-uploadthing-be-adapter\": \"server-sdk\",\n                    \"x-uploadthing-api-key\": Redacted.value(apiKey)\n                }), httpClient.execute, Effect.tapBoth({\n                    onSuccess: logHttpClientResponse(\"UploadThing API Response\"),\n                    onFailure: logHttpClientError(\"Failed to request UploadThing API\")\n                }), Effect.flatMap(HttpClientResponse.schemaBodyJson(responseSchema)), Effect.scoped);\n            }).pipe(Effect.catchTag(\"ConfigError\", (e)=>new UploadThingError({\n                    code: \"INVALID_SERVER_CONFIG\",\n                    message: \"There was an error with the server configuration. More info can be found on this error's `cause` property\",\n                    cause: e\n                })), Effect.withLogSpan(\"utapi.#requestUploadThing\"));\n        this.executeAsync = async (program, signal)=>{\n            const exit = await program.pipe(Effect.withLogSpan(\"utapi.#executeAsync\"), (e)=>this.runtime.runPromiseExit(e, signal ? {\n                    signal\n                } : undefined));\n            if (exit._tag === \"Failure\") {\n                throw Cause.squash(exit.cause);\n            }\n            return exit.value;\n        };\n        this./**\n   * Request to delete files from UploadThing storage.\n   * @param {string | string[]} fileKeys\n   *\n   * @example\n   * await deleteFiles(\"2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\");\n   *\n   * @example\n   * await deleteFiles([\"2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\",\"1649353b-04ea-48a2-9db7-31de7f562c8d_image2.jpg\"])\n   *\n   * @example\n   * await deleteFiles(\"myCustomIdentifier\", { keyType: \"customId\" })\n   */ deleteFiles = async (keys, opts)=>{\n            guardServerOnly();\n            const { keyType = this.defaultKeyType } = opts ?? {};\n            class DeleteFileResponse extends S.Class(\"DeleteFileResponse\")({\n                success: S.Boolean,\n                deletedCount: S.Number\n            }) {\n            }\n            return await this.executeAsync(this.requestUploadThing(\"/v6/deleteFiles\", keyType === \"fileKey\" ? {\n                fileKeys: Arr.ensure(keys)\n            } : {\n                customIds: Arr.ensure(keys)\n            }, DeleteFileResponse).pipe(Effect.withLogSpan(\"deleteFiles\")));\n        };\n        this./**\n   * Request file URLs from UploadThing storage.\n   * @param {string | string[]} fileKeys\n   *\n   * @example\n   * const data = await getFileUrls(\"2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\");\n   * console.log(data); // [{key: \"2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\", url: \"https://uploadthing.com/f/2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\"}]\n   *\n   * @example\n   * const data = await getFileUrls([\"2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\",\"1649353b-04ea-48a2-9db7-31de7f562c8d_image2.jpg\"])\n   * console.log(data) // [{key: \"2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\", url: \"https://uploadthing.com/f/2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\" },{key: \"1649353b-04ea-48a2-9db7-31de7f562c8d_image2.jpg\", url: \"https://uploadthing.com/f/1649353b-04ea-48a2-9db7-31de7f562c8d_image2.jpg\"}]\n   *\n   * @deprecated - See https://docs.uploadthing.com/working-with-files#accessing-files for info how to access files\n   */ getFileUrls = async (keys, opts)=>{\n            guardServerOnly();\n            const { keyType = this.defaultKeyType } = opts ?? {};\n            class GetFileUrlResponse extends S.Class(\"GetFileUrlResponse\")({\n                data: S.Array(S.Struct({\n                    key: S.String,\n                    url: S.String\n                }))\n            }) {\n            }\n            return await this.executeAsync(this.requestUploadThing(\"/v6/getFileUrl\", keyType === \"fileKey\" ? {\n                fileKeys: Arr.ensure(keys)\n            } : {\n                customIds: Arr.ensure(keys)\n            }, GetFileUrlResponse).pipe(Effect.withLogSpan(\"getFileUrls\")));\n        };\n        this./**\n   * Request file list from UploadThing storage.\n   * @param {object} opts\n   * @param {number} opts.limit The maximum number of files to return\n   * @param {number} opts.offset The number of files to skip\n   *\n   * @example\n   * const data = await listFiles({ limit: 1 });\n   * console.log(data); // { key: \"2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\", id: \"2e0fdb64-9957-4262-8e45-f372ba903ac8\" }\n   */ listFiles = async (opts)=>{\n            guardServerOnly();\n            class ListFileResponse extends S.Class(\"ListFileResponse\")({\n                hasMore: S.Boolean,\n                files: S.Array(S.Struct({\n                    id: S.String,\n                    customId: S.NullOr(S.String),\n                    key: S.String,\n                    name: S.String,\n                    size: S.Number,\n                    status: S.Literal(\"Deletion Pending\", \"Failed\", \"Uploaded\", \"Uploading\"),\n                    uploadedAt: S.Number\n                }))\n            }) {\n            }\n            return await this.executeAsync(this.requestUploadThing(\"/v6/listFiles\", {\n                ...opts\n            }, ListFileResponse).pipe(Effect.withLogSpan(\"listFiles\")));\n        };\n        this.renameFiles = async (updates)=>{\n            guardServerOnly();\n            class RenameFileResponse extends S.Class(\"RenameFileResponse\")({\n                success: S.Boolean\n            }) {\n            }\n            return await this.executeAsync(this.requestUploadThing(\"/v6/renameFiles\", {\n                updates: Arr.ensure(updates)\n            }, RenameFileResponse).pipe(Effect.withLogSpan(\"renameFiles\")));\n        };\n        this.getUsageInfo = async ()=>{\n            guardServerOnly();\n            class GetUsageInfoResponse extends S.Class(\"GetUsageInfoResponse\")({\n                totalBytes: S.Number,\n                appTotalBytes: S.Number,\n                filesUploaded: S.Number,\n                limitBytes: S.Number\n            }) {\n            }\n            return await this.executeAsync(this.requestUploadThing(\"/v6/getUsageInfo\", {}, GetUsageInfoResponse).pipe(Effect.withLogSpan(\"getUsageInfo\")));\n        };\n        this./** Request a presigned url for a private file(s) */ getSignedURL = async (key, opts)=>{\n            guardServerOnly();\n            const expiresIn = opts?.expiresIn ? parseTimeToSeconds(opts.expiresIn) : undefined;\n            const { keyType = this.defaultKeyType } = opts ?? {};\n            if (opts?.expiresIn && isNaN(expiresIn)) {\n                throw new UploadThingError({\n                    code: \"BAD_REQUEST\",\n                    message: \"expiresIn must be a valid time string, for example '1d', '2 days', or a number of seconds.\"\n                });\n            }\n            if (expiresIn && expiresIn > 86400 * 7) {\n                throw new UploadThingError({\n                    code: \"BAD_REQUEST\",\n                    message: \"expiresIn must be less than 7 days (604800 seconds).\"\n                });\n            }\n            class GetSignedUrlResponse extends S.Class(\"GetSignedUrlResponse\")({\n                url: S.String\n            }) {\n            }\n            return await this.executeAsync(this.requestUploadThing(\"/v6/requestFileAccess\", keyType === \"fileKey\" ? {\n                fileKey: key,\n                expiresIn\n            } : {\n                customId: key,\n                expiresIn\n            }, GetSignedUrlResponse).pipe(Effect.withLogSpan(\"getSignedURL\")));\n        };\n        this./**\n   * Update the ACL of a file or set of files.\n   *\n   * @example\n   * // Make a single file public\n   * await utapi.updateACL(\"2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\", \"public-read\");\n   *\n   * // Make multiple files private\n   * await utapi.updateACL(\n   *   [\n   *     \"2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\",\n   *     \"1649353b-04ea-48a2-9db7-31de7f562c8d_image2.jpg\",\n   *   ],\n   *   \"private\",\n   * );\n   */ updateACL = async (keys, acl, opts)=>{\n            guardServerOnly();\n            const { keyType = this.defaultKeyType } = opts ?? {};\n            const updates = Arr.ensure(keys).map((key)=>{\n                return keyType === \"fileKey\" ? {\n                    fileKey: key,\n                    acl\n                } : {\n                    customId: key,\n                    acl\n                };\n            });\n            const responseSchema = S.Struct({\n                success: S.Boolean\n            });\n            return await this.executeAsync(this.requestUploadThing(\"/v6/updateACL\", {\n                updates\n            }, responseSchema).pipe(Effect.withLogSpan(\"updateACL\")));\n        };\n        // Assert some stuff\n        guardServerOnly();\n        this.fetch = opts?.fetch ?? globalThis.fetch;\n        this.defaultKeyType = opts?.defaultKeyType ?? \"fileKey\";\n        this.runtime = makeRuntime(this.fetch, this.opts);\n    }\n    uploadFiles(files, opts) {\n        guardServerOnly();\n        const program = Effect.forEach(Arr.ensure(files), (file)=>uploadFile(file, opts ?? {}).pipe(Effect.match({\n                onSuccess: (data)=>({\n                        data,\n                        error: null\n                    }),\n                onFailure: (error)=>({\n                        data: null,\n                        error\n                    })\n            }))).pipe(Effect.map((ups)=>Array.isArray(files) ? ups : ups[0]), Effect.tap((res)=>Effect.logDebug(\"Finished uploading\").pipe(Effect.annotateLogs(\"uploadResult\", res))), Effect.withLogSpan(\"uploadFiles\"));\n        return this.executeAsync(program, opts?.signal);\n    }\n    uploadFilesFromUrl(urls, opts) {\n        guardServerOnly();\n        const program = Effect.forEach(Arr.ensure(urls), (url)=>downloadFile(url).pipe(Effect.flatMap((file)=>uploadFile(file, opts ?? {})), Effect.match({\n                onSuccess: (data)=>({\n                        data,\n                        error: null\n                    }),\n                onFailure: (error)=>({\n                        data: null,\n                        error\n                    })\n            }))).pipe(Effect.map((ups)=>Array.isArray(urls) ? ups : ups[0]), Effect.tap((res)=>Effect.logDebug(\"Finished uploading\").pipe(Effect.annotateLogs(\"uploadResult\", res))), Effect.withLogSpan(\"uploadFiles\")).pipe(Effect.withLogSpan(\"uploadFilesFromUrl\"));\n        return this.executeAsync(program, opts?.signal);\n    }\n}\n\nconst createUploadthing = (opts)=>createBuilder(opts);\nconst createRouteHandler = (opts)=>{\n    return makeAdapterHandler((ev)=>Effect.succeed({\n            req: \"request\" in ev ? ev.request : ev,\n            res: undefined,\n            event: undefined\n        }), (ev)=>Effect.succeed(\"request\" in ev ? ev.request : ev), opts, \"server\");\n};\nconst extractRouterConfig = (router)=>Effect.runSync(extractRouterConfig$1(router));\n\nexport { UTApi, UTFile, createRouteHandler, createUploadthing, extractRouterConfig };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 1960, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}